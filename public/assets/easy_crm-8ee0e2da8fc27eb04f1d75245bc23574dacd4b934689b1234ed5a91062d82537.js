EASY.crm.add_decimal_correction=function(t,e,a){let n=$(".easy_crm_case_items-association-insertion-node"),c=0,i=$(".easy_crm_case_item_total");for(let t=0;t<i.length;t++)c+=+i[t].value;let s=Math.round(100*(c-c.toFixed()))/100;s<.5&&(s*=-1),$(".add_fields").click();let r=n.find("input.easy_crm_case_item_price_per_unit:last");n.find("input.easy_crm_case_item_amount:last").val("1.0"),n.find("input.easy_crm_case_item_price_id:last").val(a),n.find("input.easy_crm_case_item_unit:last").val(e),n.find("input.easy_crm_case_item_name:last").val(t),r.val(s),n.find("input.easy_crm_case_item_discount:last").val("0.0"),EASY.crm.recalculateCrmCaseItemTotalPrice(r)},EASY.crm.recalculateCrmCaseItemTotalPrice=function(t){var e=$(t).closest("tr"),a=e.find("input[id$=_amount]").val(),n=e.find("input[id$=_discount]").val(),c=e.find("input[id$=_price_per_unit]").val(),i=e.find("input[id$=_total_price]"),s=a*c*(1-n/100);isNaN(s)&&(s=0),i.val(s.toFixed(2));var r=$(t).closest("tbody"),o=$(t).closest("table").find("tfoot td.total_sum span"),l=r.find("input[id$=_total_price]"),_=r.find(".easy_crm_case_item_currency").html(),u=0;l.each(function(){u+=parseFloat($(this).val())}),o.html(u+" "+_)},EASY.crm.toggleHiddableAttributes=function(t){$(".attribute-hidden").toggle("highlight","slow"),$(t).prev().toggleClass("open"),$(".toggle-box").toggleClass("box"),initEasyAutocomplete(),ERUI.document.trigger("erui_interface_change_vertical")},EASY.schedule.late(function(){$("#easy_crm_case_currency").change(function(){$(".easy_crm_case_item_currency").html($(this).val())}),$(".easy_crm_case_items-association-insertion-node").on("cocoon:before-insert",function(t,e){e.find(".easy_crm_case_item_currency").html($("#easy_crm_case_currency").val())})}),EASY.crm.repeatButton=function(t){var e=$(t).closest("tr"),a=$(t).attr("data-class"),n=e.find("."+a).val();e.nextAll("tr").find("."+a).val(n).trigger("change")},EASY.schedule.require(function(t){"use strict";let e={};const a=["issue","easy_contact","easy_crm_case","easy_calculation_project_client","project"];EASY.contacts=EASY.contacts||{},EASY.contacts.registerAssignableEntity=function(t,a){e[t]=a},EASY.contacts.getEntityDataFromDropperTarget=function(e){return t('div.easy-dropper-target[data-drop-action="'+e+'"]').data()},EASY.contacts.isRegisteredAndCurrent=function(t){return e[t]&&EASY.contacts.getEntityDataFromDropperTarget(t)},EASY.contacts.getCurrentEntity=function(){let t=null;for(const[n,c]of a.entries())if(EASY.contacts.isRegisteredAndCurrent(c)){t=e[c];break}return t},EASY.contacts.initEasyContactsAssignable=function(){const e=EASY.contacts.easyContactToolbarLocalize();let a=EASY.contacts.getCurrentEntity();if(!a)return;const n=EASY.contacts.getEntityDataFromDropperTarget(a.dropAction),c=c=>{if(a.url){let e,i=t(c.target).closest("li").data(),s=a.getAttributes(n,i);e={url:a.url,data:s,type:"POST",complete:e=>{try{t.each(t.parseJSON(e.responseText),(e,a)=>{if(a){let n=t("<div/>").attr({"class":"flash "+e}).html(t("<span/>").text(a));n.append(t("<a/>").attr({"class":"icon-close",href:"javascript:$(this).closest('.flash').fadeOut(500, function(){$(this).remove()})"})),t("#content .flash")[0]?t("#content .flash").replaceWith(n):t("#content").prepend(n)}})}catch(a){console.error("contacts toolbar:",a.message)}}},a.ajaxParams&&t.extend(e,a.ajaxParams),t.ajax(e)}else a.callback&&"function"==typeof a.callback?a.callback(n,contactData):alert(e.wrongParams)};t("#easy_contacts_toolbar_list li.assignable-list-item").each((e,n)=>{t(n).data();let i=t('<div class="push-right"><div/>'),s=t("<a></a>",{"class":(a.cssIcon||"icon-relation")+" assign-contact-link",title:a.assignToTitle});i.append(s),t(n).append(i),t(s).click(c)})},t.fn.easy_contacts_toolbar=function(e){var a={moreToDoLists:!1},n=t.extend(!0,{},a,e),c={afterOpen:function(){i.find("input").focus()}};c=t.extend(!0,{},c,n);var i=t(this).easySlidingPanel(c);i.find(".expander-panel > .expander-panel-content")}},"jQuery");