function toggleEasyQueryType(a){var e=a.closest(".module-content");a.next("span").find("input, select").attr("disabled",!1),e.find("input.easy-query-epm-query-type:radio:not(:checked)").next("span").find("input, select").attr("disabled",!0),e.find(".easy-query-type-settings-container .easy-query-type-settings-container-filters, .easy-query-type-settings-container .easy-query-type-settings-container-column-options").toggle(e.find('[id$="query_type_2"]').prop("checked"))}$(function(){$(document).on("change",".easy-query-epm-query-type",function(a){toggleEasyQueryType($(a.target))})});var PageLayout={current_tab:1,tab_element:!1,tabs_initialized:!1,__panelID:"easy_jquery_tab_panel",__tabOptions:{},__easytabsOptions:{},getActiveTab:function(){var a=PageLayout.tab_element&&PageLayout.tab_element.find("#easy_page_tabs li.selected");return a.length>=1&&a},getActiveTabId:function(){var a=PageLayout.getActiveTab();return!(!a||!a.find("span[data-tab-id]"))&&a.find("span[data-tab-id]").data().tabId},getActivePanel:function(){var a=PageLayout.__tabOptions,e=PageLayout.tab_element&&PageLayout.tab_element.find("."+a.panelID+"."+a.activeClass);return e.length>=1&&e},getActivePanelId:function(){var a=PageLayout.getActiveTab();return a&&a.find("span[data-tab-id]")?PageLayout.__panelID+"-"+a.find("span[data-tab-id]").data().tabId:a?(a.tabId=a[0].id.match(/\d+/g),PageLayout.__panelID+"-"+a.tabId[0]):PageLayout.__panelID+"-0"},initEditableTabs:function(a){var e=$.extend({},{active:0,activeID:0,elementID:"easy_page_tabs",tabsContainerSelector:"div.tabs-container",tabID:"easy_jquery_tab",panelID:"easy_jquery_tab_panel",activeClass:"selected"},a);PageLayout.__panelID=e.panelID,PageLayout.__tabOptions=jQuery.extend(!0,{},e),PageLayout.__easytabsOptions={tabs:e.tabsContainerSelector+" > ul > li",defaultTab:"#"+e.tabID+"-"+e.activeID,tabActiveClass:e.activeClass,panelActiveClass:e.activeClass,panelClass:e.panelID,panelContext:$("#easy_jquery_tabs_panels")},setAttrToUrl=PageLayout.setAttrToUrl;var t=$("#"+e.elementID).easytabs(PageLayout.__easytabsOptions);t.on("easytabs:before",function(){$oldPanel=PageLayout.getActivePanel(),$oldPanel&&PageLayout.checkPanelCKeditorsDirty($oldPanel)}),t.on("easytabs:ajax:complete",function(a,e,t,s,n){if("error"==n);else{var i=$(e).closest("li").find(".icon-edit"),l=i.attr("href");l=setAttrToUrl(l,"is_preloaded",!0),i.attr("href",l)}}),PageLayout.tab_element=t,t.find("ul").sortable({update:function(a,e){var t=e.item.find(".easy-sortable-list-handle"),s={data:{format:"json"}};s.data.reorder_to_position=e.item.index()+1,$.ajax(t.data().url,{data:s.data,type:"PUT"}),PageLayout.refreshTabs(),PageLayout.change_link_current_tab($(".add-tab-button"));var n=$(e.item).find(".icon-edit"),i=n.attr("href");i=setAttrToUrl(i,"is_preloaded",!1),n.attr("href",i)}}),t.on("ajax:success","a.icon-del",function(){var a=$(this).closest("li");panelID=PageLayout.getPanelIDforTab(a),a.remove(),$("#"+panelID).remove(),PageLayout.refreshTabs()}),t.on("change","input, select, textarea",function(){$(this).closest(".easy-page-module-form").attr("data-changed",!0)}),PageLayout.tabs_initialized=!0},refreshAddModule:function(){$(".add-module-select").off("change").change(function(a){a.preventDefault(),PageLayout.addModule.call(this)})},refreshTabs:function(){et=PageLayout.tab_element.data("easytabs"),et.getTabs()},getPanelIDforTab:function(a){return $a=a.children("a"),panelID=$a.data("target"),panelID!==undefined&&null!==panelID?a.data("easytabs").ajax=$a.attr("href"):panelID=$a.attr("href"),panelID=panelID.match(/#([^\?]+)/)[1],panelID},initSortable:function(a){var e=$.extend({},{tabIdPrefix:"easy_jquery_tab_panel",tabPos:!1,tab_id:!1,zoneName:!1,updateUrl:!1},a);if(!1!==e.tab_id&&!1!==e.tabPos&&e.zoneName&&e.updateUrl){var t=e.tabIdPrefix+"-"+e.tab_id;$("#tab"+e.tabPos+"-list-"+e.zoneName).parent().hasClass("grid-stack-zone")||$("#tab"+e.tabPos+"-list-"+e.zoneName).sortable({connectWith:"#"+t+" .easy-page-zone",handle:".handle",start:function(a,e){var t=$(e.item).find(".cke");if(t.length>0){var s=CKEDITOR.instances[t.attr("id").replace(/^cke_/,"")];current_ck_text=s.getData(),current_ck_config=s.config,s.destroy()}},stop:function(a,e){var t=$(e.item).find("textarea");if(t.length>0)try{EASY.ckeditor.init(t[0],current_ck_config,function(a){a.setData(current_ck_text)})}catch(s){}},update:function(){var a=$(this).sortable("serialize",{key:"list-"+e.zoneName+"[]",expression:/module_(.*)/});$.post(e.updateUrl+"&"+a)}})}else typeof console!=typeof undefined&&console.warn("Zone "+e.zoneName+"was not initialized.")},addModule:function(a,e,t){var s,n,i;void 0===a?(s=$(this),n=s.parent("form"),a=PageLayout.url_with_current_tab_param(s.data("url")),i=n.serializeArray(),e=n.closest(".easy-page-zone")):(i={module_id:t},n=e.find(".add-module-edit-content form"),s=n.find("select")),$.ajax(a,{method:"POST",data:i,success:function(a){$module=$(a),n.length>0?n.parent().after($module):e.prepend($module),s.length>0&&(s[0].selectedIndex=0),e.find(".easy-page-module-form:first").attr("data-changed",!0),e.trigger("easy_page:module_added",{page_module:$module,page_zone:e})}})},returnModule:function(a,e,t,s){$.ajax(a,{method:"POST",data:{module_id:e},success:function(a){var e=$(a);t.append(e),s()},error:function(a,e){console.log("Cannot find module"+e)}})},cloneModuleWithUrl:function(a,e,t){var s=PageLayout.url_with_current_tab_param(t);$.post(s,function(t){var s=$(t);a.prepend(s),a.find(".easy-page-module-form:first").attr("data-changed",!0),a.trigger("easy_page:module_added",{page_module:s,page_zone:a,clone:e})})},removeModule:function(a){PageLayout.removeModuleWithUrl(a,$(a).attr("href"))},removeModuleWithUrl:function(a,e,t){var s=$(a);t&&!confirm(t)||$.post(e,function(){var a=s.closest(".easy-page-module");a.fadeOut("fast",function(){a.closest(".easy-page-zone").trigger("easy_page:module_removed",{page_module:a}),a.remove()})})},prepareSubmitModules:function(){var a=PageLayout.getActivePanelId(),e=PageLayout.getActiveTab();$("#t").val(e?e.index()+1:1),PageLayout.checkPanelCKeditorsDirty($("#"+a));var t=$("#easy-page_modules-settings-form");$(".easy-page-module-form[data-changed=true], #easy_jquery_tab_panel-0 .easy-page-module-form").not("#easy_grid_sidebarClone .easy-page-module-form").each(function(){var a=$(this).attr("data-uuid"),e="before_submit_module_inside_"+a;"function"==typeof window[e]&&window[e](),PageLayout.runCallbacks("beforeSave",a),$("input:not(.ui-autocomplete-input), input.serialize, select, textarea:not(.wiki-edit)",this).each(function(){var a=$(this);a.clone().hide().appendTo(t).val(a.val())}),$(".wiki-edit",this).each(function(){var a;a="undefined"!=typeof CKEDITOR&&CKEDITOR.instances[this.id]?CKEDITOR.instances[this.id].getData():$(this).val(),$("<input>").attr("type","hidden").attr("name",this.name).val(a).appendTo(t)})}),$(".definition-global-filters, .page-tab-settings").find("input, select, textarea").not(":disabled").each(function(){$(this).clone().hide().appendTo(t).val(this.value)})},submitModules:function(){$("#easy-page_modules-settings-form").submit()},addTab:function(){return $("#easy_page_editable_tabs_container").load($(this).attr("href")),!1},editTab:function(a){return $(a).closest("li").load($(a).attr("href")),!1},change_link_current_tab:function(a){var e=PageLayout.url_with_current_tab_param(a.attr("href"));a.attr("href",e)},url_with_current_tab_param:function(a){return $tab=PageLayout.getActiveTab(),!1!==$tab&&(a=PageLayout.setAttrToUrl(a,"tab_id",$tab.find(".easy_tab_id").data("tab-id"))),a},checkPanelCKeditorsDirty:function(a){if(typeof CKEDITOR==typeof undefined)return!0;a.find("textarea").each(function(){var a=CKEDITOR.instances[$(this).attr("id")];if(typeof a==typeof undefined)return!0;a.checkDirty()&&$(this).closest(".easy-page-module-form").attr("data-changed",!0)})},setAttrToUrl:function(a,e,t){var s=RegExp(e+"=[^&]+");return a.match(s)?a.replace(s,e+"="+t):(a.match(/\?/)?a.match(/\&$/)||(a+="&"):a+="?",a+=e+"="+t)},callbacks:{beforeSave:{}},runCallbacks:function(a,e){var t=this.callbacks[a];if(t){var s=t[e=e.replace(/-/g,"_")];if(s)for(var n=0;n<s.length;n++)s[n]()}},beforeSave:function(a,e){var t=this.callbacks.beforeSave;t[a=a.replace(/-/g,"_")]||(t[a]=[]),t[a].push(e)},removeBeforeSave:function(a){var e=this.callbacks.beforeSave;e[a=a.replace(/-/g,"_")]||(e[a]=[]),e[a]=e[a].filter(function(){})}};!function(a){a.easytabs=function(e,t){var s,n,i,l,o,r,d=this,c=a(e),u={animate:!0,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:!0,cycle:!1,collapsible:!1,collapsedClass:"collapsed",collapsedByDefault:!0,uiTabs:!1,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionInEasing:"swing",transitionOutEasing:"swing",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",transitionCollapseEasing:"swing",transitionUncollapseEasing:"swing",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:!0,event:"click",panelContext:c},p={fast:200,normal:400,slow:600};d.init=function(){d.settings=r=a.extend({},u,t),r.bind_str=r.event+".easytabs",r.uiTabs&&(r.tabActiveClass="ui-tabs-selected",r.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all",r.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all",r.tabClass="ui-state-default ui-corner-top",r.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom"),r.collapsible&&t.defaultTab!==undefined&&t.collpasedByDefault===undefined&&(r.collapsedByDefault=!1),"string"==typeof r.animationSpeed&&(r.animationSpeed=p[r.animationSpeed]),a("a.anchor").remove().prependTo("body"),c.data("easytabs",{}),d.setTransitions(),d.getTabs(),f(),h(),y(),C(),T(),c.attr("data-easytabs",!0)},d.setTransitions=function(){i=r.animate?{show:r.transitionIn,hide:r.transitionOut,speed:r.animationSpeed,collapse:r.transitionCollapse,uncollapse:r.transitionUncollapse,halfSpeed:r.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}},d.getTabs=function(){var e;d.tabs=c.find(r.tabs),d.panels=a(),d.tabs.each(function(){var t=a(this),s=t.children("a"),n=s.data("target");t.data("easytabs",{}),n!==undefined&&null!==n?t.data("easytabs").ajax=s.attr("href"):n=s.attr("href"),n=n.match(/#([^\?]+)/)[1],(e=r.panelContext.find("#"+n)).length?(e.data("easytabs",{position:e.css("position"),visibility:e.css("visibility")}),e.not("."+r.panelActiveClass).hide(),d.panels=d.panels.add(e),t.data("easytabs").panel=e):(d.tabs=d.tabs.not(t),"console"in window&&console.warn("Warning: tab without matching panel for selector '#"+n+"' removed from set"))})},d.selectTab=function(a,e){window.location.hash.match(/^[^\?]*/)[0];var t=a.parent().data("easytabs").panel,s=a.parent().data("easytabs").ajax;r.collapsible&&!o&&(a.hasClass(r.tabActiveClass)||a.hasClass(r.collapsedClass))?d.toggleTabCollapse(a,t,s,e):a.hasClass(r.tabActiveClass)&&t.hasClass(r.panelActiveClass)&&r.cache||v(a,t,s,e)},d.toggleTabCollapse=function(a,e,t,s){d.panels.stop(!0,!0),b(c,"easytabs:before",[a,e,r])&&(d.tabs.filter("."+r.tabActiveClass).removeClass(r.tabActiveClass).children().removeClass(r.tabActiveClass),a.hasClass(r.collapsedClass)?(!t||r.cache&&a.parent().data("easytabs").cached||(c.trigger("easytabs:ajax:beforeSend",[a,e]),e.load(t,function(t,s,n){a.parent().data("easytabs").cached=!0,c.trigger("easytabs:ajax:complete",[a,e,t,s,n])})),a.parent().removeClass(r.collapsedClass).addClass(r.tabActiveClass).children().removeClass(r.collapsedClass).addClass(r.tabActiveClass),e.addClass(r.panelActiveClass)[i.uncollapse](i.speed,r.transitionUncollapseEasing,function(){c.trigger("easytabs:midTransition",[a,e,r]),"function"==typeof s&&s()})):(a.addClass(r.collapsedClass).parent().addClass(r.collapsedClass),e.removeClass(r.panelActiveClass)[i.collapse](i.speed,r.transitionCollapseEasing,function(){c.trigger("easytabs:midTransition",[a,e,r]),"function"==typeof s&&s()})))},d.matchTab=function(a){return d.tabs.find("[href='"+a+"'],[data-target='"+a+"']").first()},d.matchInPanel=function(a){return a&&d.validId(a)?d.panels.filter(":has("+a+")").first():[]},d.validId=function(a){return a.substr(1).match(/^[A-Za-z]+[A-Za-z0-9\-_:\.].$/)},d.selectTabFromHashChange=function(){var a,e=window.location.hash.match(/^[^\?]*/)[0],t=d.matchTab(e);r.updateHash&&(t.length?(o=!0,d.selectTab(t)):(a=d.matchInPanel(e)).length?(e="#"+a.attr("id"),t=d.matchTab(e),o=!0,d.selectTab(t)):s.hasClass(r.tabActiveClass)||r.cycle||(""===e||d.matchTab(l).length||c.closest(e).length)&&(o=!0,d.selectTab(n)))},d.cycleTabs=function(e){r.cycle&&(e%=d.tabs.length,$tab=a(d.tabs[e]).children("a").first(),o=!0,d.selectTab($tab,function(){setTimeout(function(){d.cycleTabs(e+1)},r.cycle)}))},d.publicMethods={select:function(e){var t;0===(t=d.tabs.filter(e)).length?0===(t=d.tabs.find("a[href='"+e+"']")).length&&0===(t=d.tabs.find("a"+e)).length&&0===(t=d.tabs.find("[data-target='"+e+"']")).length&&0===(t=d.tabs.find("a[href$='"+e+"']")).length&&a.error("Tab '"+e+"' does not exist in tab set"):t=t.children("a").first(),d.selectTab(t)}};var b=function(e,t,s){var n=a.Event(t);return e.trigger(n,s),!1!==n.result},f=function(){c.addClass(r.containerClass),d.tabs.parent().addClass(r.tabsClass),d.tabs.addClass(r.tabClass),d.panels.addClass(r.panelClass)},h=function(){var e,t=window.location.hash.match(/^[^\?]*/)[0],i=d.matchTab(t).parent();1===i.length?(s=i,r.cycle=!1):(e=d.matchInPanel(t)).length?(t="#"+e.attr("id"),s=d.matchTab(t).parent()):0===(s=d.tabs.parent().find(r.defaultTab)).length&&a.error("The specified default tab ('"+r.defaultTab+"') could not be found in the tab set ('"+r.tabs+"') out of "+d.tabs.length+" tabs."),n=s.children("a").first(),g(i)},g=function(e){var t,i;r.collapsible&&0===e.length&&r.collapsedByDefault?s.addClass(r.collapsedClass).children().addClass(r.collapsedClass):(t=a(s.data("easytabs").panel),!(i=s.data("easytabs").ajax)||r.cache&&s.data("easytabs").cached||(c.trigger("easytabs:ajax:beforeSend",[n,t]),t.load(i,function(a,e,i){s.data("easytabs").cached=!0,c.trigger("easytabs:ajax:complete",[n,t,a,e,i])})),s.data("easytabs").panel.show().addClass(r.panelActiveClass),s.addClass(r.tabActiveClass).children().addClass(r.tabActiveClass)),c.trigger("easytabs:initialised",[n,t])},y=function(){c.on(r.bind_str,r.tabs+" > a",function(e){r.cycle=!1,o=!1,d.selectTab(a(this)),e.preventDefault?e.preventDefault():e.returnValue=!1})},v=function(a,e,t,s){if(d.panels.stop(!0,!0),b(c,"easytabs:before",[a,e,r])){var n,u,p,f,h=d.panels.filter(":visible"),g=e.parent(),y=window.location.hash.match(/^[^\?]*/)[0];r.animate&&(n=m(e),u=h.length?_(h):0,p=n-u),l=y,f=function(){c.trigger("easytabs:midTransition",[a,e,r]),r.animate&&"fadeIn"==r.transitionIn&&p<0&&g.animate({height:g.height()+p},i.halfSpeed).css({"min-height":""}),r.updateHash&&!o?window.location.hash="#"+e.attr("id"):o=!1,e[i.show](i.speed,r.transitionInEasing,function(){g.css({height:"","min-height":""}),c.trigger("easytabs:after",[a,e,r]),"function"==typeof s&&s()})},!t||r.cache&&a.parent().data("easytabs").cached||(c.trigger("easytabs:ajax:beforeSend",[a,e]),e.load(t,function(t,s,n){a.parent().data("easytabs").cached=!0,c.trigger("easytabs:ajax:complete",[a,e,t,s,n])})),r.animate&&"fadeOut"==r.transitionOut&&(p>0?g.animate({height:g.height()+p},i.halfSpeed):g.css({"min-height":g.height()})),d.tabs.filter("."+r.tabActiveClass).removeClass(r.tabActiveClass).children().removeClass(r.tabActiveClass),d.tabs.filter("."+r.collapsedClass).removeClass(r.collapsedClass).children().removeClass(r.collapsedClass),a.parent().addClass(r.tabActiveClass).children().addClass(r.tabActiveClass),d.panels.filter("."+r.panelActiveClass).removeClass(r.panelActiveClass),e.addClass(r.panelActiveClass),h.length?h[i.hide](i.speed,r.transitionOutEasing,f):e[i.uncollapse](i.speed,r.transitionUncollapseEasing,f)}},m=function(e){if(e.data("easytabs")&&e.data("easytabs").lastHeight)return e.data("easytabs").lastHeight;var t,s,n=e.css("display");try{t=a("<div></div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})}catch(i){t=a("<div></div>",{visibility:"hidden",overflow:"hidden"})}return s=e.wrap(t).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight(),e.unwrap(),e.css({position:e.data("easytabs").position,visibility:e.data("easytabs").visibility,display:n}),e.data("easytabs").lastHeight=s,s},_=function(a){var e=a.outerHeight();return a.data("easytabs")?a.data("easytabs").lastHeight=e:a.data("easytabs",{lastHeight:e}),e},C=function(){"function"==typeof a(window).hashchange?a(window).hashchange(function(){d.selectTabFromHashChange()}):a.address&&"function"==typeof a.address.change&&a.address.change(function(){d.selectTabFromHashChange()})},T=function(){var a;r.cycle&&(a=d.tabs.index(s),setTimeout(function(){d.cycleTabs(a+1)},r.cycle))};d.init()},a.fn.easytabs=function(e){var t=arguments;return this.each(function(){var s=a(this),n=s.data("easytabs");if(undefined!==n&&!0!==n||(n=new a.easytabs(this,e),s.data("easytabs",n)),n.publicMethods[e])return n.publicMethods[e](Array.prototype.slice.call(t,1))})}}(jQuery);