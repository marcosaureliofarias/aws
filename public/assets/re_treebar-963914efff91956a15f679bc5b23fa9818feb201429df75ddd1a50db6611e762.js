function createJSTreeContextmenuItems(){var e={create:!1,rename:!1,remove:!1,ccp:!1};return window.re_options.allowed_to_edit&&(e["new"]={label:window.re_options.create_in_str,separator_before:!1,separator_after:!1,icon:"new-icon",submenu:window.re_options.new_submenu},e.sibling={label:window.re_options.create_below_str,separator_before:!1,separator_after:!0,icon:"new-icon",submenu:window.re_options.sibling_submenu},e.edit={label:window.re_options.edit_str,icon:"edit-icon d",action:function(e){var o=$(e.reference).attr("data-id"),n=window.re_options.edit_link;window.location.href=n+"/"+o+"/edit"}},e["delete"]={label:window.re_options.delete_str,icon:"delete-icon",action:function(e){var o=$(e.reference).attr("data-id"),n=window.re_options.delete_link;window.location.href=n+"/"+o+"/how_to_delete"}}),window.re_options.bulk_edit&&(e={change_status:{label:window.re_options.changeStatusStr,icon:"edit-icon d",submenu:window.re_options.change_status_submenu}}),e}EASY.schedule.late(function(){var e=$("#tree"),o={core:{multiple:!0,data:{url:window.re_options.tree_root_link,data:function(e){$(e.reference).attr("data-id");return{id:e.id}}},check_callback:!0,animation:100,strings:{loading:window.re_options.tree_loading_str},themes:{stripes:!1,dots:!0}},types:{"#":{max_children:1},project:{icon:"re_project-icon"},re_goal:{icon:"re_goal-icon"},re_task:{icon:"re_task-icon"},re_subtask:{icon:"re_subtask-icon"},re_vision:{icon:"re_vision-icon"},re_attachment:{icon:"re_attachment-icon"},re_workarea:{icon:"re_workarea-icon"},re_user_profile:{icon:"re_user_profile-icon"},re_section:{icon:"re_section-icon"},re_requirement:{icon:"re_requirement-icon"},re_scenario:{icon:"re_scenario-icon"},re_processword:{icon:"re_processword-icon"},re_rationale:{icon:"re_rationale-icon"},re_use_case:{icon:"re_use_case-icon"},re_visualization:{icon:"re_visualization-icon"}},contextmenu:{select_node:!1,show_at_node:!1,items:createJSTreeContextmenuItems()},checkbox:{three_state:!1,whole_node:!1,tie_selection:!1}};window.re_options.allowed_to_edit?o.plugins=["dnd","ui","contextmenu","types","checkbox"]:window.re_options.allowed_to_view&&(o.plugins=["ui","contextmenu","types","wholerow"]),e.jstree(o),e.on("close_node.jstree",function(e,o){$.ajax({url:window.re_options.tree_close_link+"/"+o.node.id.replace("node_","")})}),e.on("select_node.jstree",function(e,o){var n=o.node.a_attr["data-href"];n!==undefined&&(window.location.href=n)}),e.on("check_node.jstree uncheck_node.jstree",function(e,o){window.re_options.bulk_edit=0!==o.selected.length,$("#tree").jstree(!0).settings.contextmenu.items=createJSTreeContextmenuItems()}),e.on("open_node.jstree",function(e,o){$.ajax({url:window.re_options.tree_open_link+"/"+o.node.id.replace("node_","")})}),e.on("move_node.jstree",function(e,o){var n=o.parent.replace("node_",""),t=o.node.id.replace("node_",""),i=o.position;$.ajax({async:!1,type:"POST",url:window.re_options.delegate_tree_drop_link,data:{id:t,parent_id:n,position:i,authenticity_token:window.re_options.form_authenticity_token}})})});