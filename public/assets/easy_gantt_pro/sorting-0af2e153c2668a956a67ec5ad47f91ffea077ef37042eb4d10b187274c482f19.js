window.ysy=window.ysy||{},ysy.pro=ysy.pro||{},ysy.pro.sorting=EasyGem.extend(ysy.pro.sorting,{name:"Sorter",patch:function(){var t=new ysy.data.Data;t.init({_name:"Sorting",sortBy:null}),ysy.settings.sorting=t,gantt.attachEvent("onGanttReady",$.proxy(this.bindClick,gantt))},columnCompares:{start_date:function(t,n){return(t._start_date||t.start_date)-(n._start_date||n.start_date)},due_date:function(t,n){return(t._end_date||t.end_date)-(n._end_date||n.end_date)},subject:function(t,n){return t.text.localeCompare(n.text)},priority:function(t,n){return t.priority_position-n.priority_position}},defaultCompare:function(t){return function(n,r){return+n.columns[t]&&+r.columns[t]?+n.columns[t]-+r.columns[t]:n.columns[t].toString().localeCompare(r.columns[t].toString())}},getCompareFunction:function(t,n){var r=n?-1:1;if(this.columnCompares[t])var e=this.columnCompares[t];else e=this.defaultCompare(t);return function(t,n){var o=ysy.pro.sorting.columnsValidation(t,n);return o===undefined?(0===(o=e(t,n))&&(o=t.order-n.order),r*o):o}},columnsValidation:function(t,n){return t.columns?n.columns?undefined:1:n.columns?-1:t.type===n.type&&t.subtype===n.subtype?t.text.localeCompare(n.text):t.order-n.order},bindClick:function(){this._click.gantt_grid_head_cell=dhtmlx.bind(function(t,n,r){var e=r.getAttribute("column_id");if(this.callEvent("onGridHeaderClick",[e,t])){if(this._sort&&this._sort.direction&&this._sort.name==e){var o=this._sort.direction;if("desc"===o)return this._sort=null,void this.sort();o="desc"==o?"asc":"desc"}else o="asc";var i=ysy.pro.sorting.getCompareFunction(e,"desc"==o);this._sort={name:e,criteria:i,direction:o},this.sort(i)}},this)}});