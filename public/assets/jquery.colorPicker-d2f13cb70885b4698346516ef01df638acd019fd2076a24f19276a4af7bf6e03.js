!function(o){var e,r,c,t=0,n={control:o('<div class="colorPicker-picker">&nbsp;</div>'),palette:o('<div id="colorPicker_palette" class="colorPicker-palette" />'),swatch:o('<div class="colorPicker-swatch">&nbsp;</div>'),hexLabel:o('<label for="colorPicker_hex">Hex</label>'),hexField:o('<input type="text" id="colorPicker_hex" />')},l="transparent";o.fn.colorPicker=function(e){return this.each(function(){var r,c=o(this),i=o.extend({},o.fn.colorPicker.defaults,e),a=o.fn.colorPicker.toHex(c.val().length>0?c.val():i.pickerDefault),s=n.control.clone(),d=n.palette.clone().attr("id","colorPicker_palette-"+t),f=n.hexLabel.clone(),k=n.hexField.clone(),h=d[0].id;o.each(i.colors,function(e){r=n.swatch.clone(),i.colors[e]===l?(r.addClass(l).text("X"),o.fn.colorPicker.bindPalette(k,r,l)):(r.css("background-color","#"+this),o.fn.colorPicker.bindPalette(k,r)),r.appendTo(d)}),f.attr("for","colorPicker_hex-"+t),k.attr({id:"colorPicker_hex-"+t,value:a}),k.on("keydown",function(e){if(13===e.keyCode){var r=o.fn.colorPicker.toHex(o(this).val());o.fn.colorPicker.changeColor(r||c.val())}27===e.keyCode&&o.fn.colorPicker.hidePalette()}),k.on("keyup",function(e){var r=o.fn.colorPicker.toHex(o(e.target).val());o.fn.colorPicker.previewColor(r||c.val())}),o('<div class="colorPicker_hexWrap" />').append(f).appendTo(d),d.find(".colorPicker_hexWrap").append(k),o("body").append(d),d.hide(),s.css("background-color",a),s.on("click",function(){c.is(":not(:disabled)")&&o.fn.colorPicker.togglePalette(o("#"+h),o(this))}),e&&e.onColorChange?s.data("onColorChange",e.onColorChange):s.data("onColorChange",function(){}),c.after(s),c.on("change",function(){c.next(".colorPicker-picker").css("background-color",o.fn.colorPicker.toHex(o(this).val()))}),c.val(a).hide(),t++})},o.extend(!0,o.fn.colorPicker,{toHex:function(o){if(o.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i))return"#"===o.charAt(0)?o:"#"+o;if(!o.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/))return!1;var e=[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)],r=function(o){if(o.length<2)for(var e=0,r=2-o.length;e<r;e++)o="0"+o;return o};return 3===e.length?"#"+r(e[0].toString(16))+r(e[1].toString(16))+r(e[2].toString(16)):void 0},checkMouse:function(c){var t=r,n=o(c.target).parents("#"+t.attr("id")).length;c.target===o(t)[0]||c.target===e[0]||n>0||o.fn.colorPicker.hidePalette()},hidePalette:function(){o(document).off("mousedown",o.fn.colorPicker.checkMouse),o(".colorPicker-palette").hide()},showPalette:function(r){var c=e.prev("input").val();r.css({top:e.offset().top+e.outerHeight(),left:e.offset().left}),o("#color_value").val(c),r.show(),o(document).on("mousedown",o.fn.colorPicker.checkMouse)},togglePalette:function(c,t){t&&(e=t),(r=c).is(":visible")?o.fn.colorPicker.hidePalette():o.fn.colorPicker.showPalette(c)},changeColor:function(r){e.css("background-color",r),e.prev("input").val(r).change(),o.fn.colorPicker.hidePalette(),e.data("onColorChange").call(e,o(e).prev("input").attr("id"),r)},previewColor:function(o){e.css("background-color",o)},bindPalette:function(r,t,n){n=n||o.fn.colorPicker.toHex(t.css("background-color")),t.on({click:function(){c=n,o.fn.colorPicker.changeColor(n)},mouseover:function(){c=r.val(),o(this).css("border-color","#598FEF"),r.val(n),o.fn.colorPicker.previewColor(n)},mouseout:function(){o(this).css("border-color","#000"),r.val(e.css("background-color")),r.val(c),o.fn.colorPicker.previewColor(c)}})}}),o.fn.colorPicker.defaults={pickerDefault:"FF0000",colors:["000000","993300","333300","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","999999","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC"],addColors:[]}}(jQuery);