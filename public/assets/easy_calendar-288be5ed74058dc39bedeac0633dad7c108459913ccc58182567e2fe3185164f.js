!function(e,t){function n(t){e.extend(!0,De,t)}function r(n,r,c){function u(e){ae?g()&&(E(),M(e)):d()}function d(){r.theme?"ui":"fc",n.addClass("fc"),r.isRTL?n.addClass("fc-rtl"):n.addClass("fc-ltr"),r.theme&&n.addClass("ui-widget"),ae=e("<div class='fc-content' style='position:relative'/>").prependTo(n),ne=new a(te,r),(re=ne.render())&&n.prepend(re),y(r.defaultView),r.handleWindowResize&&e(window).resize(S),m()||v()}function v(){setTimeout(function(){!oe.start&&m()&&D()},0)}function h(){oe&&(ee("viewDestroy",oe,oe,oe.element),oe.triggerEventDestroy()),e(window).unbind("resize",S),ne.destroy(),ae.remove(),n.removeClass("fc fc-rtl ui-widget")}function g(){return n.is(":visible")}function m(){return e("body").is(":visible")}function y(e){oe&&e==oe.name||C(e)}function C(t){ve++,oe&&(ee("viewDestroy",oe,oe,oe.element),P(),oe.triggerEventDestroy(),$(),oe.element.remove(),ne.deactivateButton(oe.name)),ne.activateButton(t),oe=new Ee[t](e("<div class='fc-view fc-view-"+t+"' style='position:relative'/>").appendTo(ae),te),D(),Z(),ve--}function D(e){(!oe.start||e||he<oe.start||he>=oe.end)&&g()&&M(e)}function M(e){ve++,oe.start&&(ee("viewDestroy",oe,oe,oe.element),P(),N()),$(),oe.render(he,e||0),x(),Z(),(oe.afterRender||z)(),W(),L(),ee("viewRender",oe,oe,oe.element),oe.trigger("viewDisplay",de),ve--,F()}function T(){g()&&(P(),N(),E(),x(),R())}function E(){se=r.contentHeight?r.contentHeight:r.height?r.height-(re?re.height():0)-H(ae):Math.round(ae.width()/Math.max(r.aspectRatio,.5))}function x(){se===t&&E(),ve++,oe.setHeight(se),oe.setWidth(ae.width()),ve--,ie=n.outerWidth()}function S(){if(!ve)if(oe.start){var e=++fe;setTimeout(function(){e==fe&&!ve&&g()&&ie!=(ie=n.outerWidth())&&(ve++,T(),oe.trigger("windowResize",de),ve--)},200)}else v()}function _(){N(),O()}function k(e){N(),R(e)}function R(e){g()&&(oe.setEventData(pe),oe.renderEvents(pe,e),oe.trigger("eventAfterAllRender"))}function N(){oe.triggerEventDestroy(),oe.clearEvents(),oe.clearEventData()}function F(){!r.lazyFetching||ce(oe.visStart,oe.visEnd)?O():R()}function O(){ue(oe.visStart,oe.visEnd)}function I(e){pe=e,R()}function A(e){k(e)}function W(){ne.updateTitle(oe.title)}function L(){var e=new Date;e>=oe.start&&e<oe.end?ne.disableButton("today"):ne.enableButton("today")}function j(e,n,r){oe.select(e,n,r===t||r)}function P(){oe&&oe.unselect()}function q(){D(-1)}function Y(){D(1)}function B(){i(he,-1),D()}function U(){i(he,1),D()}function K(){he=new Date,D()}function V(e,t,n){e instanceof Date?he=f(e):p(he,e,t,n),D()}function J(e,n,r){e!==t&&i(he,e),n!==t&&s(he,n),r!==t&&l(he,r),D()}function X(){return f(he)}function $(){ae.css({width:"100%",height:ae.height(),overflow:"hidden"})}function Z(){ae.css({width:"",height:"",overflow:""})}function G(){return oe}function Q(e,n){if(n===t)return r[e];"height"!=e&&"contentHeight"!=e&&"aspectRatio"!=e||(r[e]=n,T())}function ee(e,t){if(r[e])return r[e].apply(t||de,Array.prototype.slice.call(arguments,2))}var te=this;te.options=r,te.render=u,te.destroy=h,te.refetchEvents=_,te.reportEvents=I,te.reportEventChange=A,te.rerenderEvents=k,te.changeView=y,te.select=j,te.unselect=P,te.prev=q,te.next=Y,te.prevYear=B,te.nextYear=U,te.today=K,te.gotoDate=V,te.incrementDate=J,te.formatDate=function(e,t){return b(e,t,r)},te.formatDates=function(e,t,n){return w(e,t,n,r)},te.getDate=X,te.getView=G,te.option=Q,te.trigger=ee,o.call(te,r,c);var ne,re,ae,oe,ie,se,le,ce=te.isFetchNeeded,ue=te.fetchEvents,de=n[0],fe=0,ve=0,he=new Date,pe=[];p(he,r.year,r.month,r.date),r.droppable&&e(document).bind("dragstart",function(t,n){var a=t.target,o=e(a);if(!o.parents(".fc").length){var i=r.dropAccept;(e.isFunction(i)?i.call(a,o):o.is(i))&&(le=a,oe.dragStart(le,t,n))}}).bind("dragstop",function(e,t){le&&(oe.dragStop(le,e,t),le=null)})}function a(t,n){function r(){if(f=n.theme?"ui":"fc",n.header)return v=e("<table class='fc-header' style='width:100%'/>").append(e("<tr/>").append(o("left")).append(o("center")).append(o("right")))}function a(){v.remove()}function o(r){var a=e("<td class='fc-header-"+r+"'/>"),o=n.header[r];return o&&e.each(o.split(" "),function(r){var o;r>0&&a.append("<span class='fc-header-space'/>"),e.each(this.split(","),function(r,i){var s;if("title"==i)a.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),o&&o.addClass(f+"-corner-right"),o=null;else if(t[i]?s=t[i]:Ee[i]&&(s=function(){u.removeClass(f+"-state-hover"),t.changeView(i)}),s){var l=n.theme?L(n.buttonIcons,i):null,c=L(n.buttonText,i),u=e("<span class='fc-button fc-button-"+i+" "+f+"-state-default'>"+(l?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+l+"'/></span>":c)+"</span>").click(function(){u.hasClass(f+"-state-disabled")||s()}).mousedown(function(){u.not("."+f+"-state-active").not("."+f+"-state-disabled").addClass(f+"-state-down")}).mouseup(function(){u.removeClass(f+"-state-down")}).hover(function(){u.not("."+f+"-state-active").not("."+f+"-state-disabled").addClass(f+"-state-hover")},function(){u.removeClass(f+"-state-hover").removeClass(f+"-state-down")}).appendTo(a);P(u),o||u.addClass(f+"-corner-left"),o=u}}),o&&o.addClass(f+"-corner-right")}),a}function i(e){v.find("h2").html(e)}function s(e){v.find("span.fc-button-"+e).addClass(f+"-state-active")}function l(e){v.find("span.fc-button-"+e).removeClass(f+"-state-active")}function c(e){v.find("span.fc-button-"+e).addClass(f+"-state-disabled")}function u(e){v.find("span.fc-button-"+e).removeClass(f+"-state-disabled")}var d=this;d.render=r,d.destroy=a,d.updateTitle=i,d.activateButton=s,d.deactivateButton=l,d.disableButton=c,d.enableButton=u;var f,v=e([])}function o(n,r){function a(e,t){return!T||e<T||t>E}function o(e,t){T=e,E=t,O=[];var n=++H,r=R.length;N=r;for(var a=0;a<r;a++)i(R[a],n)}function i(t,r){s(t,function(a){if(r==H){if(a){n.eventDataTransform&&(a=e.map(a,n.eventDataTransform)),t.eventDataTransform&&(a=e.map(a,t.eventDataTransform));for(var o=0;o<a.length;o++)a[o].source=t,b(a[o]);O=O.concat(a)}--N||_(O)}})}function s(t,r){var a,o,i=Te.sourceFetchers;for(a=0;a<i.length;a++){if(!0===(o=i[a](t,T,E,r)))return;if("object"==typeof o)return void s(o,r)}var l=t.events;if(l)e.isFunction(l)?(m(),l(f(T),f(E),function(e){r(e),y()})):e.isArray(l)?r(l):r();else if(t.url){var c,u=t.success,d=t.error,v=t.complete;c=e.isFunction(t.data)?t.data():t.data;var h=e.extend({},c||{}),p=U(t.startParam,n.startParam),g=U(t.endParam,n.endParam);p&&(h[p]=Math.round(+T/1e3)),g&&(h[g]=Math.round(+E/1e3)),m(),e.ajax(e.extend({},xe,t,{data:h,success:function(t){t=t||[];var n=B(u,this,arguments);e.isArray(n)&&(t=n),r(t)},error:function(){B(d,this,arguments),r()},complete:function(){B(v,this,arguments),y()}}))}else r()}function l(e){(e=c(e))&&(N++,i(e,H))}function c(t){if(e.isFunction(t)||e.isArray(t)?t={events:t}:"string"==typeof t&&(t={url:t}),"object"==typeof t)return w(t),R.push(t),t}function u(t){R=e.grep(R,function(e){return!C(e,t)}),O=e.grep(O,function(e){return!C(e.source,t)}),_(O)}function d(e){var t,n,r=O.length,a=S().defaultEventEnd,o=e.start-e._start,i=e.end?e.end-(e._end||a(e)):0;for(t=0;t<r;t++)(n=O[t])._id==e._id&&n!=e&&(n.start=new Date(+n.start+o),e.end?n.end?n.end=new Date(+n.end+i):n.end=new Date(+a(n)+i):n.end=null,n.title=e.title,n.url=e.url,n.allDay=e.allDay,n.className=e.className,n.editable=e.editable,n.color=e.color,n.backgroundColor=e.backgroundColor,n.borderColor=e.borderColor,n.textColor=e.textColor,b(n));b(e),_(O)}function v(e,t){b(e),e.source||(t&&(k.events.push(e),e.source=k),O.push(e)),_(O)}function h(t){if(t){if(!e.isFunction(t)){var n=t+"";t=function(e){return e._id==n}}O=e.grep(O,t,!0);for(r=0;r<R.length;r++)e.isArray(R[r].events)&&(R[r].events=e.grep(R[r].events,t,!0))}else{O=[];for(var r=0;r<R.length;r++)e.isArray(R[r].events)&&(R[r].events=[])}_(O)}function p(t){return e.isFunction(t)?e.grep(O,t):t?(t+="",e.grep(O,function(e){return e._id==t})):O}function m(){F++||x("loading",null,!0,S())}function y(){--F||x("loading",null,!1,S())}function b(e){var r=e.source||{},a=U(r.ignoreTimezone,n.ignoreTimezone);e._id=e._id||(e.id===t?"_fc"+Se++:e.id+""),e.date&&(e.start||(e.start=e.date),delete e.date),e._start=f(e.start=g(e.start,a)),e.end=g(e.end,a),e.end&&e.end<=e.start&&(e.end=null),e._end=e.end?f(e.end):null,e.allDay===t&&(e.allDay=U(r.allDayDefault,n.allDayDefault)),e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[]}function w(e){e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[];for(var t=Te.sourceNormalizers,n=0;n<t.length;n++)t[n](e)}function C(e,t){return e&&t&&D(e)==D(t)}function D(e){return("object"==typeof e?e.events||e.url:"")||e}var M=this;M.isFetchNeeded=a,M.fetchEvents=o,M.addEventSource=l,M.removeEventSource=u,M.updateEvent=d,M.renderEvent=v,M.removeEvents=h,M.clientEvents=p,M.normalizeEvent=b;for(var T,E,x=M.trigger,S=M.getView,_=M.reportEvents,k={events:[]},R=[k],H=0,N=0,F=0,O=[],z=0;z<r.length;z++)c(r[z])}function i(e,t,n){return e.setFullYear(e.getFullYear()+t),n||d(e),e}function s(e,t,n){if(+e){var r=e.getMonth()+t,a=f(e);for(a.setDate(1),a.setMonth(r),e.setMonth(r),n||d(e);e.getMonth()!=a.getMonth();)e.setDate(e.getDate()+(e<a?1:-1))}return e}function l(e,t,n){if(+e){var r=e.getDate()+t,a=f(e);a.setHours(9),a.setDate(r),e.setDate(r),n||d(e),c(e,a)}return e}function c(e,t){if(+e)for(;e.getDate()!=t.getDate();)e.setTime(+e+(e<t?1:-1)*Re)}function u(e,t){return e.setMinutes(e.getMinutes()+t),e}function d(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function f(e,t){return t?d(new Date(+e)):new Date(+e)}function v(){var e,t=0;do{e=new Date(1970,t++,1)}while(e.getHours());return e}function h(e,t){return Math.round((f(e,!0)-f(t,!0))/ke)}function p(e,n,r,a){n!==t&&n!=e.getFullYear()&&(e.setDate(1),e.setMonth(0),e.setFullYear(n)),r!==t&&r!=e.getMonth()&&(e.setDate(1),e.setMonth(r)),a!==t&&e.setDate(a)}function g(e,n){return"object"==typeof e?e:"number"==typeof e?new Date(1e3*e):"string"==typeof e?e.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(e)):(n===t&&(n=!0),m(e,n)||(e?new Date(e):null)):null}function m(e,t){var n=e.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var r=new Date(n[1],0,1);if(t||!n[13]){var a=new Date(n[1],0,1,9,0);n[3]&&(r.setMonth(n[3]-1),a.setMonth(n[3]-1)),n[5]&&(r.setDate(n[5]),a.setDate(n[5])),c(r,a),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(1e3*Number("0."+n[12])),c(r,a)}else if(r.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),r.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var o=60*Number(n[16])+(n[18]?Number(n[18]):0);o*="-"==n[15]?1:-1,r=new Date(+r+60*o*1e3)}return r}function y(e){if("number"==typeof e)return 60*e;if("object"==typeof e)return 60*e.getHours()+e.getMinutes();var t=e.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(t){var n=parseInt(t[1],10);return t[3]&&(n%=12,"p"==t[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(t[2]?parseInt(t[2],10):0)}}function b(e,t,n){return w(e,null,t,n)}function w(e,t,n,r){r=r||De;var a,o,i,s,l=e,c=t,u=n.length,d="";for(a=0;a<u;a++)if("'"==(o=n.charAt(a))){for(i=a+1;i<u;i++)if("'"==n.charAt(i)){l&&(d+=i==a+1?"'":n.substring(a+1,i),a=i);break}}else if("("==o){for(i=a+1;i<u;i++)if(")"==n.charAt(i)){var f=b(l,n.substring(a+1,i),r);parseInt(f.replace(/\D/,""),10)&&(d+=f),a=i;break}}else if("["==o){for(i=a+1;i<u;i++)if("]"==n.charAt(i)){var v=n.substring(a+1,i);(f=b(l,v,r))!=b(c,v,r)&&(d+=f),a=i;break}}else if("{"==o)l=t,c=e;else if("}"==o)l=e,c=t;else{for(i=u;i>a;i--)if(s=Ne[n.substring(a,i)]){l&&(d+=s(l,r)),a=i-1;break}i==a&&l&&(d+=o)}return d}function C(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1}function D(e){return e.end?M(e.end,e.allDay):l(f(e.start),1)}function M(e,t){return e=f(e),t||e.getHours()||e.getMinutes()?l(e,1):d(e)}function T(n,r,a){n.unbind("mouseover").mouseover(function(n){for(var o,i,s,l=n.target;l!=this;)o=l,l=l.parentNode;(i=o._fci)!==t&&(o._fci=t,s=r[i],a(s.event,s.element,s),e(n.target).trigger(n)),n.stopPropagation()})}function E(t,n,r){for(var a,o=0;o<t.length;o++)(a=e(t[o])).width(Math.max(0,n-S(a,r)))}function x(t,n,r){for(var a,o=0;o<t.length;o++)(a=e(t[o])).height(Math.max(0,n-H(a,r)))}function S(e,t){return _(e)+R(e)+(t?k(e):0)}function _(t){return(parseFloat(e.css(t[0],"paddingLeft",!0))||0)+(parseFloat(e.css(t[0],"paddingRight",!0))||0)}function k(t){return(parseFloat(e.css(t[0],"marginLeft",!0))||0)+(parseFloat(e.css(t[0],"marginRight",!0))||0)}function R(t){return(parseFloat(e.css(t[0],"borderLeftWidth",!0))||0)+(parseFloat(e.css(t[0],"borderRightWidth",!0))||0)}function H(e,t){return N(e)+O(e)+(t?F(e):0)}function N(t){return(parseFloat(e.css(t[0],"paddingTop",!0))||0)+(parseFloat(e.css(t[0],"paddingBottom",!0))||0)}function F(t){return(parseFloat(e.css(t[0],"marginTop",!0))||0)+(parseFloat(e.css(t[0],"marginBottom",!0))||0)}function O(t){return(parseFloat(e.css(t[0],"borderTopWidth",!0))||0)+(parseFloat(e.css(t[0],"borderBottomWidth",!0))||0)}function z(){}function I(e,t){return e-t}function A(e){return Math.max.apply(Math,e)}function W(e){return(e<10?"0":"")+e}function L(e,n){if(e[n]!==t)return e[n];for(var r,a=n.split(/(?=[A-Z])/),o=a.length-1;o>=0;o--)if((r=e[a[o].toLowerCase()])!==t)return r;return e[""]}function j(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function P(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function q(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function Y(e,t){var n=e.source||{},r=e.color,a=n.color,o=t("eventColor"),i=e.backgroundColor||r||n.backgroundColor||a||t("eventBackgroundColor")||o,s=e.borderColor||r||n.borderColor||a||t("eventBorderColor")||o,l=e.textColor||n.textColor||t("eventTextColor"),c=[];return i&&c.push("background-color:"+i),s&&c.push("border-color:"+s),l&&c.push("color:"+l),c.join(";")}function B(t,n,r){if(e.isFunction(t)&&(t=[t]),t){var a,o;for(a=0;a<t.length;a++)o=t[a].apply(n,r)||o;return o}}function U(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==t)return arguments[e]}function K(e,t){function n(e,t){t&&(s(e,t),e.setDate(1));var n=a("firstDay"),d=f(e,!0);d.setDate(1);var v=s(f(d),1),p=f(d);l(p,-(p.getDay()-n+7)%7),i(p);var g=f(v);l(g,(7-g.getDay()+n)%7),i(g,-1,!0);var m=c(),y=Math.round(h(g,p)/7);"fixed"==a("weekMode")&&(l(g,7*(6-y)),y=6),r.title=u(d,a("titleFormat")),r.start=d,r.end=v,r.visStart=p,r.visEnd=g,o(y,m,!0)}var r=this;r.render=n,X.call(r,e,t,"month");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,c=r.getCellsPerWeek,u=t.formatDate}function V(e,t){function n(e,t){t&&l(e,7*t);var n=l(f(e),-(e.getDay()-a("firstDay")+7)%7),u=l(f(n),7),d=f(n);i(d);var v=f(u);i(v,-1,!0);var h=s();r.start=n,r.end=u,r.visStart=d,r.visEnd=v,r.title=c(d,l(f(v),-1),a("titleFormat")),o(1,h,!1)}var r=this;r.render=n,X.call(r,e,t,"basicWeek");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,s=r.getCellsPerWeek,c=t.formatDates}function J(e,t){function n(e,t){t&&l(e,t),i(e,t<0?-1:1);var n=f(e,!0),c=l(f(n),1);r.title=s(e,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=c,o(1,1,!1)}var r=this;r.render=n,X.call(r,e,t,"basicDay");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,s=t.formatDate}function X(t,n,r){function a(e,t,n){ee=e,te=t,ne=n,o(),Y||i(),s()}function o(){se=ve("theme")?"ui":"fc",le=ve("columnFormat"),ce=ve("weekNumbers"),ue=ve("weekNumberTitle"),fe="iso"!=ve("weekNumberCalculation")?"w":"W"}function i(){X=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(t)}function s(){var n=c();A&&A.remove(),A=e(n).appendTo(t),W=A.find("thead"),L=W.find(".fc-day-header"),Y=A.find("tbody"),B=Y.find("tr"),U=Y.find(".fc-day"),K=B.find("td:first-child"),V=B.eq(0).find(".fc-day > div"),J=B.eq(0).find(".fc-day-content > div"),q(W.add(W.find("tr"))),q(B),B.eq(0).addClass("fc-first"),B.filter(":last").addClass("fc-last"),U.each(function(t,n){var r=Me(Math.floor(t/te),t%te);he("dayRender",I,r,e(n))}),y(U)}function c(){return"<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+u()+v()+"</table>"}function u(){var e,t,n=se+"-widget-header",r="";for(r+="<thead><tr>",ce&&(r+="<th class='fc-week-number "+n+"'>"+j(ue)+"</th>"),e=0;e<te;e++)t=Me(0,e),r+="<th class='fc-day-header fc-"+_e[t.getDay()]+" "+n+"'>"+j(xe(t,le))+"</th>";return r+="</tr></thead>"}function v(){var e,t,n,r=se+"-widget-content",a="";for(a+="<tbody>",e=0;e<ee;e++){for(a+="<tr class='fc-week'>",ce&&(n=Me(e,0),a+="<td class='fc-week-number "+r+"'><div>"+j(xe(n,fe))+"</div></td>"),t=0;t<te;t++)a+=h(n=Me(e,t));a+="</tr>"}return a+="</tbody>"}function h(e){var t=se+"-widget-content",n=I.start.getMonth(),r=d(new Date),a="",o=["fc-day","fc-"+_e[e.getDay()],t];return e.getMonth()!=n&&o.push("fc-other-month"),+e==+r?o.push("fc-today",se+"-state-highlight"):e<r?o.push("fc-past"):o.push("fc-future"),a+="<td class='"+o.join(" ")+"' data-date='"+xe(e,"yyyy-MM-dd")+"'><div>",ne&&(a+="<div class='fc-day-number'>"+e.getDate()+"</div>"),a+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>"}function p(t){var n,r,a,o=t-W.height();"variable"==ve("weekMode")?n=r=Math.floor(o/(1==ee?2:6)):(n=Math.floor(o/ee),r=o-n*(ee-1)),K.each(function(t,o){t<ee&&(a=e(o)).find("> div").css("min-height",(t==ee-1?r:n)-H(a))})}function g(e){Z=e,oe.clear(),ie.clear(),Q=0,ce&&(Q=W.find("th.fc-week-number").outerWidth()),G=Math.floor((Z-Q)/te),E(L.slice(0,-1),G)}function y(e){e.click(b).mousedown(De)}function b(t){if(!ve("selectable")){var n=m(e(this).data("date"));he("dayClick",this,n,!0,t)}}function w(e,t,n){n&&re.build();for(var r=Ee(e,t),a=0;a<r.length;a++){var o=r[a];y(C(o.row,o.leftCol,o.row,o.rightCol))}}function C(e,n,r,a){var o=re.rect(e,n,r,a,t);return pe(o,t)}function D(e){return f(e)}function M(e,t){w(e,l(f(t),1),!0)}function T(){we()}function x(e,t,n){var r=Te(e),a=U[r.row*te+r.col];he("dayClick",a,e,t,n)}function S(e,t){ae.start(function(e){we(),e&&C(e.row,e.col,e.row,e.col)},t)}function _(e,t,n){var r=ae.stop();if(we(),r){var a=Me(r);he("drop",e,a,!0,t,n)}}function k(e){return f(e.start)}function R(e){return oe.left(e)}function N(e){return oe.right(e)}function F(e){return ie.left(e)}function O(e){return ie.right(e)}function z(e){return B.eq(e)}var I=this;I.renderBasic=a,I.setHeight=p,I.setWidth=g,I.renderDayOverlay=w,I.defaultSelectionEnd=D,I.renderSelection=M,I.clearSelection=T,I.reportDayClick=x,I.dragStart=S,I.dragStop=_,I.defaultEventEnd=k,I.getHoverListener=function(){return ae},I.colLeft=R,I.colRight=N,I.colContentLeft=F,I.colContentRight=O,I.getIsCellAllDay=function(){return!0},I.allDayRow=z,I.getRowCnt=function(){return ee},I.getColCnt=function(){return te},I.getColWidth=function(){return G},I.getDaySegmentContainer=function(){return X},de.call(I,t,n,r),me.call(I),ge.call(I),$.call(I);var A,W,L,Y,B,U,K,V,J,X,Z,G,Q,ee,te,ne,re,ae,oe,ie,se,le,ce,ue,fe,ve=I.opt,he=I.trigger,pe=I.renderOverlay,we=I.clearOverlays,De=I.daySelectionMousedown,Me=I.cellToDate,Te=I.dateToCell,Ee=I.rangeToSegments,xe=n.formatDate;P(t.addClass("fc-grid")),re=new ye(function(t,n){var r,a,o;L.each(function(t,i){r=e(i),a=r.offset().left,t&&(o[1]=a),o=[a],n[t]=o}),o[1]=a+r.outerWidth(),B.each(function(n,i){n<ee&&(r=e(i),a=r.offset().top,n&&(o[1]=a),o=[a],t[n]=o)}),o[1]=a+r.outerHeight()}),ae=new be(re),oe=new Ce(function(e){return V.eq(e)}),ie=new Ce(function(e){return J.eq(e)})}function $(){function e(e,t){n.renderDayEvents(e,t)}function t(){n.getDaySegmentContainer().empty()}var n=this;n.renderEvents=e,n.clearEvents=t,fe.call(n)}function Z(e,t){function n(e,t){t&&l(e,7*t);var n=l(f(e),-(e.getDay()-a("firstDay")+7)%7),u=l(f(n),7),d=f(n);i(d);var v=f(u);i(v,-1,!0);var h=s();r.title=c(d,l(f(v),-1),a("titleFormat")),r.start=n,r.end=u,r.visStart=d,r.visEnd=v,o(h)}var r=this;r.render=n,Q.call(r,e,t,"agendaWeek");var a=r.opt,o=r.renderAgenda,i=r.skipHiddenDays,s=r.getCellsPerWeek,c=t.formatDates}function G(e,t){function n(e,t){t&&l(e,t),i(e,t<0?-1:1);var n=f(e,!0),c=l(f(n),1);r.title=s(e,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=c,o(1)}var r=this;r.render=n,Q.call(r,e,t,"agendaDay");var a=r.opt,o=r.renderAgenda,i=r.skipHiddenDays,s=t.formatDate}function Q(n,r,a){function o(e){Fe=e,i(),Q?c():s()}function i(){Le=Ve("theme")?"ui":"fc",je=Ve("isRTL"),Pe=y(Ve("minTime")),qe=y(Ve("maxTime")),Ye=Ve("columnFormat"),Be=Ve("weekNumbers"),Ue=Ve("weekNumberTitle"),Ke="iso"!=Ve("weekNumberCalculation")?"w":"W",Re=Ve("snapMinutes")||Ve("slotMinutes")}function s(){var t,r,a,o,i,s=Le+"-widget-header",l=Le+"-widget-content",d=Ve("slotMinutes")%15==0;for(c(),ce=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),Ve("allDaySlot")?(ue=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(ce),t="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+s+" fc-agenda-axis'>"+Ve("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+s+" fc-agenda-gutter'>&nbsp;</th></tr></table>",fe=e(t).appendTo(ce),D((ve=fe.find("tr")).find("td")),ce.append("<div class='fc-agenda-divider "+s+"'><div class='fc-agenda-divider-inner'/></div>")):ue=e([]),he=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(ce),pe=e("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(he),we=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(pe),t="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",o=u(f(r=v()),qe),u(r,Pe),Oe=0,a=0;r<o;a++)t+="<tr class='fc-slot"+a+" "+((i=r.getMinutes())?"fc-minor":"")+"'><th class='fc-agenda-axis "+s+"'>"+(d&&i?"&nbsp;":at(r,Ve("axisFormat")))+"</th><td class='"+l+"'><div style='position:relative'>&nbsp;</div></td></tr>",u(r,Ve("slotMinutes")),Oe++;M((De=e(t+="</tbody></table>").appendTo(pe)).find("td"))}function c(){var t=h();Q&&Q.remove(),Q=e(t).appendTo(n),te=Q.find("thead"),ne=te.find("th").slice(1,-1),re=Q.find("tbody"),ae=re.find("td").slice(0,-1),oe=ae.find("> div"),ie=ae.find(".fc-day-content > div"),se=ae.eq(0),le=oe.eq(0),q(te.add(te.find("tr"))),q(re.add(re.find("tr")))}function h(){return"<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+p()+g()+"</table>"}function p(){var e,t,n,r=Le+"-widget-header",a="";for(a+="<thead><tr>",Be?(e=tt(0,0),t=at(e,Ke),je?t+=Ue:t=Ue+t,a+="<th class='fc-agenda-axis fc-week-number "+r+"'>"+j(t)+"</th>"):a+="<th class='fc-agenda-axis "+r+"'>&nbsp;</th>",n=0;n<Fe;n++)e=tt(0,n),a+="<th class='fc-"+_e[e.getDay()]+" fc-col"+n+" "+r+"'>"+j(at(e,Ye))+"</th>";return a+="<th class='fc-agenda-gutter "+r+"'>&nbsp;</th></tr></thead>"}function g(){var e,t,n,r,a=Le+"-widget-header",o=Le+"-widget-content",i=d(new Date),s="";for(s+="<tbody><tr><th class='fc-agenda-axis "+a+"'>&nbsp;</th>",n="",t=0;t<Fe;t++)e=tt(0,t),r=["fc-col"+t,"fc-"+_e[e.getDay()],o],+e==+i?r.push(Le+"-state-highlight","fc-today"):e<i?r.push("fc-past"):r.push("fc-future"),n+="<td class='"+r.join(" ")+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>";return s+=n,s+="<td class='fc-agenda-gutter "+o+"'>&nbsp;</td></tr></tbody>"}function m(e){e===t&&(e=Te),Te=e,ot={};var n=re.position().top,r=he.position().top,a=Math.min(e-n,De.height()+r+1);le.height(a-H(se)),ce.css("top",n),he.height(a-r-1),ke=De.find("tr:first").height()+1,He=Ve("slotMinutes")/Re,Ne=ke/He}function b(t){t,Ae.clear(),We.clear();var n=te.find("th:first");fe&&(n=n.add(fe.find("th:first"))),n=n.add(De.find("th:first")),Ee=0,E(n.width("").each(function(t,n){Ee=Math.max(Ee,e(n).outerWidth())}),Ee);var r=Q.find(".fc-agenda-gutter");fe&&(r=r.add(fe.find("th.fc-agenda-gutter")));var a=he[0].clientWidth;(Se=he.width()-a)?(E(r,Se),r.show().prev().removeClass("fc-last")):r.hide().prev().addClass("fc-last"),xe=Math.floor((a-Ee)/Fe),E(ne.slice(0,-1),xe)}function w(){function e(){he.scrollTop(r)}var t=v(),n=f(t);n.setHours(Ve("firstHour"));var r=W(t,n)+1;e(),setTimeout(e,0)}function C(){w()}function D(e){e.click(T).mousedown(Qe)}function M(e){e.click(T).mousedown(J)}function T(e){if(!Ve("selectable")){var t=Math.min(Fe-1,Math.floor((e.pageX-Q.offset().left-Ee)/xe)),n=tt(0,t),r=this.parentNode.className.match(/fc-slot(\d+)/);if(r){var a=parseInt(r[1])*Ve("slotMinutes"),o=Math.floor(a/60);n.setHours(o),n.setMinutes(a%60+Pe),Je("dayClick",ae[t],n,!1,e)}else Je("dayClick",ae[t],n,!0,e)}}function S(e,t,n){n&&ze.build();for(var r=rt(e,t),a=0;a<r.length;a++){var o=r[a];D(_(o.row,o.leftCol,o.row,o.rightCol))}}function _(e,t,n,r){var a=ze.rect(e,t,n,r,ce);return Xe(a,ce)}function k(e,t){for(var n=0;n<Fe;n++){var r=tt(0,n),a=l(f(r),1),o=new Date(Math.max(r,e)),i=new Date(Math.min(a,t));if(o<i){var s=ze.rect(0,n,0,n,pe),c=W(r,o),u=W(r,i);s.top=c,s.height=u-c,M(Xe(s,pe))}}}function R(e){return Ae.left(e)}function N(e){return We.left(e)}function F(e){return Ae.right(e)}function O(e){return We.right(e)}function z(e){return Ve("allDaySlot")&&!e.row}function A(e){var t=tt(0,e.col),n=e.row;return Ve("allDaySlot")&&n--,n>=0&&u(t,Pe+n*Re),t}function W(e,n){if(n<u(f(e=f(e,!0)),Pe))return 0;if(n>=u(f(e),qe))return De.height();var r=Ve("slotMinutes"),a=60*n.getHours()+n.getMinutes()-Pe,o=Math.floor(a/r),i=ot[o];return i===t&&(i=ot[o]=De.find("tr").eq(o).find("td div")[0].offsetTop),Math.max(0,Math.round(i-1+ke*(a%r/r)))}function L(){return ve}function Y(e){var t=f(e.start);return e.allDay?t:u(t,Ve("defaultEventMinutes"))}function B(e,t){return t?f(e):u(f(e),Ve("slotMinutes"))}function U(e,t,n){n?Ve("allDaySlot")&&S(e,l(f(t),1),!0):K(e,t)}function K(t,n){var r=Ve("selectHelper");if(ze.build(),r){var a=nt(t).col;if(a>=0&&a<Fe){var o=ze.rect(0,a,0,a,pe),i=W(t,t),s=W(t,n);if(s>i){if(o.top=i,o.height=s-i,o.left+=2,o.width-=5,e.isFunction(r)){var l=r(t,n);l&&(o.position="absolute",Me=e(l).css(o).appendTo(pe))}else o.isStart=!0,o.isEnd=!0,(Me=e(et({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},o))).css("opacity",Ve("dragOpacity"));Me&&(M(Me),pe.append(Me),E(Me,o.width,!0),x(Me,o.height,!0))}}}else k(t,n)}function V(){$e(),Me&&(Me.remove(),Me=null)}function J(t){var n;1==t.which&&Ve("selectable")&&(Ge(t),Ie.start(function(e,t){if(V(),e&&e.col==t.col&&!z(e)){var r=A(t),a=A(e);K((n=[r,u(f(r),Re),a,u(f(a),Re)].sort(I))[0],n[3])}else n=null},t),e(document).one("mouseup",function(e){Ie.stop(),n&&(+n[0]==+n[1]&&X(n[0],!1,e),Ze(n[0],n[3],!1,e))}))}function X(e,t,n){Je("dayClick",ae[nt(e).col],e,t,n)}function $(e,t){Ie.start(function(e){if($e(),e)if(z(e))_(e.row,e.col,e.row,e.col);else{var t=A(e);k(t,u(f(t),Ve("defaultEventMinutes")))}},t)}function Z(e,t,n){var r=Ie.stop();$e(),r&&Je("drop",e,A(r),z(r),t,n)}var G=this;G.renderAgenda=o,G.setWidth=b,G.setHeight=m,G.afterRender=C,G.defaultEventEnd=Y,G.timePosition=W,G.getIsCellAllDay=z,G.allDayRow=L,G.getCoordinateGrid=function(){return ze},G.getHoverListener=function(){return Ie},G.colLeft=R,G.colRight=F,G.colContentLeft=N,G.colContentRight=O,G.getDaySegmentContainer=function(){return ue},G.getSlotSegmentContainer=function(){return we},G.getMinMinute=function(){return Pe},G.getMaxMinute=function(){return qe},G.getSlotContainer=function(){return pe},G.getRowCnt=function(){return 1},G.getColCnt=function(){return Fe},G.getColWidth=function(){return xe},G.getSnapHeight=function(){return Ne},G.getSnapMinutes=function(){return Re},G.defaultSelectionEnd=B,G.renderDayOverlay=S,G.renderSelection=U,G.clearSelection=V,G.reportDayClick=X,G.dragStart=$,G.dragStop=Z,de.call(G,n,r,a),me.call(G),ge.call(G),ee.call(G);var Q,te,ne,re,ae,oe,ie,se,le,ce,ue,fe,ve,he,pe,we,De,Me,Te,Ee,xe,Se,ke,Re,He,Ne,Fe,Oe,ze,Ie,Ae,We,Le,je,Pe,qe,Ye,Be,Ue,Ke,Ve=G.opt,Je=G.trigger,Xe=G.renderOverlay,$e=G.clearOverlays,Ze=G.reportSelection,Ge=G.unselect,Qe=G.daySelectionMousedown,et=G.slotSegHtml,tt=G.cellToDate,nt=G.dateToCell,rt=G.rangeToSegments,at=r.formatDate,ot={};P(n.addClass("fc-agenda")),ze=new ye(function(t,n){function r(e){return Math.max(l,Math.min(c,e))}var a,o,i;ne.each(function(t,r){a=e(r),o=a.offset().left,t&&(i[1]=o),i=[o],n[t]=i}),i[1]=o+a.outerWidth(),Ve("allDaySlot")&&(o=(a=ve).offset().top,t[0]=[o,o+a.outerHeight()]);for(var s=pe.offset().top,l=he.offset().top,c=l+he.outerHeight(),u=0;u<Oe*He;u++)t.push([r(s+Ne*u),r(s+Ne*(u+1))])}),Ie=new be(ze),Ae=new Ce(function(e){return oe.eq(e)}),We=new Ce(function(e){return ie.eq(e)})}function ee(){function n(e,t){var n,r=e.length,o=[],i=[];for(n=0;n<r;n++)e[n].allDay?o.push(e[n]):i.push(e[n]);y("allDaySlot")&&(ee(o,t),_()),s(a(i),t)}function r(){k().empty(),R().empty()}function a(t){var n,r,a,s,l,c=P(),d=O(),v=F(),h=e.map(t,i),p=[];for(r=0;r<c;r++)for(u(n=L(0,r),d),l=te(l=o(t,h,n,u(f(n),v-d))),a=0;a<l.length;a++)(s=l[a]).col=r,p.push(s);return p}function o(e,t,n,r){var a,o,i,s,l,c,u,d,v=[],h=e.length;for(a=0;a<h;a++)i=(o=e[a]).start,(s=t[a])>n&&i<r&&(i<n?(l=f(n),u=!1):(l=i,u=!0),s>r?(c=f(r),d=!1):(c=s,d=!0),v.push({event:o,start:l,end:c,isStart:u,isEnd:d}));return v.sort(ue)}function i(e){return e.end?f(e.end):u(f(e.start),y("defaultEventMinutes"))}function s(n,r){var a,o,i,s,l,u,f,v,h,p,g,m,w,C,D,M,E=n.length,x="",_=R(),k=y("isRTL");for(a=0;a<E;a++)i=(o=n[a]).event,s=z(o.start,o.start),l=z(o.start,o.end),u=A(o.col),f=W(o.col),h=(v=(f-=.025*(v=f-u))-u)*(o.forwardCoord-o.backwardCoord),y("slotEventOverlap")&&(h=Math.max(2*(h-10),h)),k?p=(g=f-o.backwardCoord*v)-h:g=(p=u+o.backwardCoord*v)+h,p=Math.max(p,u),h=(g=Math.min(g,f))-p,o.top=s,o.left=p,o.outerWidth=h,o.outerHeight=l-s,x+=c(i,o);for(_[0].innerHTML=x,m=_.children(),a=0;a<E;a++)i=(o=n[a]).event,w=e(m[a]),!1===(C=b("eventRender",i,i,w))?w.remove():(C&&!0!==C&&(w.remove(),w=e(C).css({position:"absolute",top:o.top,left:o.left}).appendTo(_)),o.element=w,i._id===r?d(i,w,o):w[0]._fci=a,V(i,w));for(T(_,n,d),a=0;a<E;a++)(w=(o=n[a]).element)&&(o.vsides=H(w,!0),o.hsides=S(w,!0),(D=w.find(".fc-event-title")).length&&(o.contentTop=D[0].offsetTop));for(a=0;a<E;a++)(w=(o=n[a]).element)&&(w[0].style.width=Math.max(0,o.outerWidth-o.hsides)+"px",M=Math.max(0,o.outerHeight-o.vsides),w[0].style.height=M+"px",i=o.event,o.contentTop!==t&&M-o.contentTop<10&&(w.find("div.fc-event-time").text(re(i.start,y("timeFormat"))+" - "+i.title),w.find("div.fc-event-title").remove()),b("eventAfterRender",i,i,w))}function c(e,t){var n="<",r=e.url,a=(Y(e,y),["fc-event","fc-event-vert"]);return w(e)&&a.push("fc-event-draggable"),t.isStart&&a.push("fc-event-start"),t.isEnd&&a.push("fc-event-end"),a=a.concat(e.className),e.source&&(a=a.concat(e.source.className||[])),a.push("fc-event--"+e.eventType),n+=r?"a href='"+j(e.url)+"'":"div",n+=" class='"+a.join(" ")+"' style='position:absolute;top:"+t.top+"px;left:"+t.left+"px;'><div class='fc-event-inner'><div class='fc-event-time'>"+j(ae(e.start,e.end,y("timeFormat")))+"</div><div class='fc-event-title'>"+j(e.title||"")+"</div></div><div class='fc-event-bg'></div>",t.isEnd&&C(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(r?"a":"div")+">"}function d(e,t,n){var r=t.find("div.fc-event-time");w(e)&&p(e,t,r),n.isEnd&&C(e)&&g(e,t,r),E(e,t)}function v(e,t,n){function r(){c||(t.width(a).height("").draggable("option","grid",null),c=!0)}var a,o,i,s=n.isStart,c=!0,u=N(),d=q(),v=B(),p=U(),g=O();t.draggable({opacity:y("dragOpacity","month"),revertDuration:y("dragRevertDuration"),start:function(n,g){b("eventDragStart",t,e,n,g),X(e,t),a=t.width(),u.start(function(n,a){if(Q(),n){o=!1;var u=L(0,a.col),g=L(0,n.col);i=h(g,u),n.row?s?c&&(t.width(d-10),x(t,v*Math.round((e.end?(e.end-e.start)/He:y("defaultEventMinutes"))/p)),t.draggable("option","grid",[d,1]),c=!1):o=!0:(G(l(f(e.start),i),l(D(e),i)),r()),o=o||c&&!i}else r(),o=!0;t.draggable("option","revert",o)},n,"drag")},stop:function(n,a){if(u.stop(),Q(),b("eventDragStop",t,e,n,a),o)r(),t.css("filter",""),J(e,t);else{var s=0;c||(s=Math.round((t.offset().top-K().offset().top)/v)*p+g-(60*e.start.getHours()+e.start.getMinutes())),$(this,e,i,s,c,n,a)}}})}function p(e,t,n){function r(){Q(),s&&(d?(n.hide(),t.draggable("option","grid",null),G(l(f(e.start),w),l(D(e),w))):(a(C),n.css("display",""),t.draggable("option","grid",[x,S])))}function a(t){var r,a=u(f(e.start),t);e.end&&(r=u(f(e.end),t)),n.text(ae(a,r,y("timeFormat")))}var o,i,s,c,d,v,p,g,w,C,M,T=m.getCoordinateGrid(),E=P(),x=q(),S=B(),_=U();t.draggable({scroll:!1,grid:[x,S],axis:1==E&&"y",opacity:y("dragOpacity"),revertDuration:y("dragRevertDuration"),start:function(n,r){
b("eventDragStart",t,e,n,r),X(e,t),T.build(),o=t.position(),i=T.cell(n.pageX,n.pageY),s=c=!0,d=v=I(i),p=g=0,w=0,C=M=0},drag:function(e,n){var a=T.cell(e.pageX,e.pageY);if(s=!!a){if(d=I(a),(p=Math.round((n.position.left-o.left)/x))!=g){var l=L(0,i.col),u=i.col+p;u=Math.max(0,u),u=Math.min(E-1,u);var f=L(0,u);w=h(f,l)}d||(C=Math.round((n.position.top-o.top)/S)*_)}s==c&&d==v&&p==g&&C==M||(r(),c=s,v=d,g=p,M=C),t.draggable("option","revert",!s)},stop:function(n,a){Q(),b("eventDragStop",t,e,n,a),s&&(d||w||C)?$(this,e,w,d?0:C,d,n,a):(s=!0,d=!1,p=0,w=0,C=0,r(),t.css("filter",""),t.css(o),J(e,t))}})}function g(e,t,n){var r,a,o=B(),i=U();t.resizable({handles:{s:".ui-resizable-handle"},grid:o,start:function(n,o){r=a=0,X(e,t),b("eventResizeStart",this,e,n,o)},resize:function(s,l){(r=Math.round((Math.max(o,t.height())-l.originalSize.height)/o))!=a&&(n.text(ae(e.start,r||e.end?u(M(e),i*r):null,y("timeFormat"))),a=r)},stop:function(n,a){b("eventResizeStop",this,e,n,a),r?Z(this,e,0,i*r,n,a):J(e,t)}})}var m=this;m.renderEvents=n,m.clearEvents=r,m.slotSegHtml=c,fe.call(m);var y=m.opt,b=m.trigger,w=m.isEventDraggable,C=m.isEventResizable,M=m.eventEnd,E=m.eventElementHandlers,_=m.setHeight,k=m.getDaySegmentContainer,R=m.getSlotSegmentContainer,N=m.getHoverListener,F=m.getMaxMinute,O=m.getMinMinute,z=m.timePosition,I=m.getIsCellAllDay,A=m.colContentLeft,W=m.colContentRight,L=m.cellToDate,P=m.getColCnt,q=m.getColWidth,B=m.getSnapHeight,U=m.getSnapMinutes,K=m.getSlotContainer,V=m.reportEventElement,J=m.showEvents,X=m.hideEvents,$=m.eventDrop,Z=m.eventResize,G=m.renderDayOverlay,Q=m.clearOverlays,ee=m.renderDayEvents,ne=m.calendar,re=ne.formatDate,ae=ne.formatDates;m.draggableDayEvent=v}function te(e){var t,n=ne(e),r=n[0];if(re(n),r){for(t=0;t<r.length;t++)ae(r[t]);for(t=0;t<r.length;t++)oe(r[t],0,0)}return ie(n)}function ne(e){var t,n,r,a=[];for(t=0;t<e.length;t++){for(n=e[t],r=0;r<a.length&&se(n,a[r]).length;r++);(a[r]||(a[r]=[])).push(n)}return a}function re(e){var t,n,r,a,o;for(t=0;t<e.length;t++)for(n=e[t],r=0;r<n.length;r++)for((a=n[r]).forwardSegs=[],o=t+1;o<e.length;o++)se(a,e[o],a.forwardSegs)}function ae(e){var n,r,a=e.forwardSegs,o=0;if(e.forwardPressure===t){for(n=0;n<a.length;n++)ae(r=a[n]),o=Math.max(o,1+r.forwardPressure);e.forwardPressure=o}}function oe(e,n,r){var a,o=e.forwardSegs;if(e.forwardCoord===t)for(o.length?(o.sort(ce),oe(o[0],n+1,r),e.forwardCoord=o[0].backwardCoord):e.forwardCoord=1,e.backwardCoord=e.forwardCoord-(e.forwardCoord-r)/(n+1),a=0;a<o.length;a++)oe(o[a],0,e.forwardCoord)}function ie(e){var t,n,r,a=[];for(t=0;t<e.length;t++)for(n=e[t],r=0;r<n.length;r++)a.push(n[r]);return a}function se(e,t,n){n=n||[];for(var r=0;r<t.length;r++)le(e,t[r])&&n.push(t[r]);return n}function le(e,t){return e.end>t.start&&e.start<t.end}function ce(e,t){return t.forwardPressure-e.forwardPressure||(e.backwardCoord||0)-(t.backwardCoord||0)||ue(e,t)}function ue(e,t){return e.start-t.start||t.end-t.start-(e.end-e.start)||(e.event.title||"").localeCompare(t.event.title)}function de(n,r,a){function o(t,n){var r=V[t];return e.isPlainObject(r)?L(r,n||a):r}function i(e,t){return r.trigger.apply(r,[e,t||W].concat(Array.prototype.slice.call(arguments,2),[W]))}function s(e){var t=e.source||{};return U(e.startEditable,t.startEditable,o("eventStartEditable"),e.editable,t.editable,o("editable"))&&!o("disableDragging")}function c(e){var t=e.source||{};return U(e.durationEditable,t.durationEditable,o("eventDurationEditable"),e.editable,t.editable,o("editable"))&&!o("disableResizing")}function d(e){Y={};var t,n,r=e.length;for(t=0;t<r;t++)n=e[t],Y[n._id]?Y[n._id].push(n):Y[n._id]=[n]}function v(){Y={},B={},K=[]}function p(e){return e.end?f(e.end):j(e)}function g(e,t){K.push({event:e,element:t}),B[e._id]?B[e._id].push(t):B[e._id]=[t]}function m(){e.each(K,function(e,t){W.trigger("eventDestroy",t.event,t.event,t.element)})}function y(e,t){t.click(function(n){if(!t.hasClass("ui-draggable-dragging")&&!t.hasClass("ui-resizable-resizing"))return i("eventClick",this,e,n)}).hover(function(t){i("eventMouseover",this,e,t)},function(t){i("eventMouseout",this,e,t)})}function b(e,t){C(e,t,"show")}function w(e,t){C(e,t,"hide")}function C(e,t,n){var r,a=B[e._id],o=a.length;for(r=0;r<o;r++)t&&a[r][0]==t[0]||a[r][n]()}function D(e,t,n,r,a,o,s){var l=t.allDay,c=t._id;T(Y[c],n,r,a),i("eventDrop",e,t,n,r,a,function(){T(Y[c],-n,-r,l),q(c)},o,s),q(c)}function M(e,t,n,r,a,o){var s=t._id;E(Y[s],n,r),i("eventResize",e,t,n,r,function(){E(Y[s],-n,-r),q(s)},a,o),q(s)}function T(e,n,r,a){r=r||0;for(var o,i=e.length,s=0;s<i;s++)o=e[s],a!==t&&(o.allDay=a),u(l(o.start,n,!0),r),o.end&&(o.end=u(l(o.end,n,!0),r)),P(o,V)}function E(e,t,n){n=n||0;for(var r,a=e.length,o=0;o<a;o++)(r=e[o]).end=u(l(p(r),t,!0),n),P(r,V)}function x(e){return"object"==typeof e&&(e=e.getDay()),$[e]}function S(){return J}function _(e,t,n){for(t=t||1;$[(e.getDay()+(n?t:0)+7)%7];)l(e,t)}function k(){return N(H(R.apply(null,arguments)))}function R(e,t){var n=W.getColCnt(),r=Q?-1:1,a=Q?n-1:0;return"object"==typeof e&&(t=e.col,e=e.row),e*n+(t*r+a)}function H(e){var t=W.visStart.getDay();return e+=Z[t],7*Math.floor(e/J)+G[(e%J+J)%J]-t}function N(e){var t=f(W.visStart);return l(t,e),t}function F(e){return I(z(O(e)))}function O(e){return h(e,W.visStart)}function z(e){var t=W.visStart.getDay();return e+=t,Math.floor(e/7)*J+Z[(e%7+7)%7]-Z[t]}function I(e){var t=W.getColCnt(),n=Q?-1:1,r=Q?t-1:0;return{row:Math.floor(e/t),col:(e%t+t)%t*n+r}}function A(e,t){for(var n=W.getRowCnt(),r=W.getColCnt(),a=[],o=O(e),i=O(t),s=z(o),l=z(i)-1,c=0;c<n;c++){var u=c*r,d=u+r-1,f=Math.max(s,u),v=Math.min(l,d);if(f<=v){var h=I(f),p=I(v),g=[h.col,p.col].sort(),m=H(f)==o,y=H(v)+1==i;a.push({row:c,leftCol:g[0],rightCol:g[1],isStart:m,isEnd:y})}}return a}var W=this;W.element=n,W.calendar=r,W.name=a,W.opt=o,W.trigger=i,W.isEventDraggable=s,W.isEventResizable=c,W.setEventData=d,W.clearEventData=v,W.eventEnd=p,W.reportEventElement=g,W.triggerEventDestroy=m,W.eventElementHandlers=y,W.showEvents=b,W.hideEvents=w,W.eventDrop=D,W.eventResize=M;var j=W.defaultEventEnd,P=r.normalizeEvent,q=r.reportEventChange,Y={},B={},K=[],V=r.options;W.isHiddenDay=x,W.skipHiddenDays=_,W.getCellsPerWeek=S,W.dateToCell=F,W.dateToDayOffset=O,W.dayOffsetToCellOffset=z,W.cellOffsetToCell=I,W.cellToDate=k,W.cellToCellOffset=R,W.cellOffsetToDayOffset=H,W.dayOffsetToDate=N,W.rangeToSegments=A;var J,X=o("hiddenDays")||[],$=[],Z=[],G=[],Q=o("isRTL");!function(){!1===o("weekends")&&X.push(0,6);for(var t=0,n=0;t<7;t++)Z[t]=n,$[t]=-1!=e.inArray(t,X),$[t]||(G[n]=t,n++);if(!(J=n))throw"invalid hiddenDays"}()}function fe(){function t(e,t){var n=r(e,!1,!0);he(n,function(e,t){N(e.event,t)}),b(n,t),he(n,function(e,t){_("eventAfterRender",e.event,e.event,t)})}function n(e,t,n){var a=r([e],!0,!1),o=[];return he(a,function(e,r){e.row===t&&r.css("top",n),o.push(r[0])}),o}function r(t,n,r){var o,l,c=V(),f=n?e("<div/>"):c,v=a(t);return i(v),o=s(v),f[0].innerHTML=o,l=f.children(),n&&c.append(l),u(v,l),he(v,function(e,t){e.hsides=S(t,!0)}),he(v,function(e,t){t.width(Math.max(0,e.outerWidth-e.hsides))}),he(v,function(e,t){e.outerHeight=t.outerHeight(!0)}),d(v,r),v}function a(e){for(var t=[],n=0;n<e.length;n++){var r=o(e[n]);t.push.apply(t,r)}return t}function o(e){for(var t=e.start,n=D(e),r=Q(t,n),a=0;a<r.length;a++)r[a].event=e;return r}function i(e){x("isRTL");for(var t=0;t<e.length;t++){var n=e[t],r=K,a=U(n.leftCol),o=r(n.rightCol);n.left=a,n.outerWidth=o-a}}function s(e){for(var t="",n=0;n<e.length;n++)t+=c(e[n]);return t}function c(e){var t="",n=x("isRTL"),r=e.event,a=r.url,o=["fc-event","fc-event-hori"];k(r)&&o.push("fc-event-draggable"),e.isStart&&o.push("fc-event-start"),e.isEnd&&o.push("fc-event-end"),o=o.concat(r.className),r.source&&(o=o.concat(r.source.className||[])),o.push("fc-event--"+r.eventType);Y(r,x);return t+=a?"<a href='"+j(a)+"'":"<div",t+=" class='"+o.join(" ")+"' style='position:absolute;left:"+e.left+"px;'><div class='fc-event-inner'>",!r.allDay&&e.isStart&&(t+="<span class='fc-event-time'>"+j(J(r.start,r.end,x("timeFormat")))+"</span>"),t+="<span class='fc-event-title'>"+j(r.title||"")+"</span></div>",e.isEnd&&R(r)&&(t+="<div class='ui-resizable-handle ui-resizable-"+(n?"w":"e")+"'>&nbsp;&nbsp;&nbsp;</div>"),t+="</"+(a?"a":"div")+">"}function u(t,n){for(var r=0;r<t.length;r++){var a=t[r],o=a.event,i=n.eq(r),s=_("eventRender",o,o,i);!1===s?i.remove():(s&&!0!==s&&(s=e(s).css({position:"absolute",left:a.left}),i.replaceWith(s),i=s),a.element=i)}}function d(e,t){var n=v(e),r=y(),a=[];if(t)for(var o=0;o<r.length;o++)r[o].height(n[o]);for(o=0;o<r.length;o++)a.push(r[o].position().top);he(e,function(e,t){t.css("top",a[e.row]+e.top)})}function v(e){for(var t=L(),n=q(),r=[],a=p(e),o=0;o<t;o++){for(var i=a[o],s=[],l=0;l<n;l++)s.push(0);for(var c=0;c<i.length;c++){var u=i[c];u.top=A(s.slice(u.leftCol,u.rightCol+1));for(l=u.leftCol;l<=u.rightCol;l++)s[l]=u.top+u.outerHeight}r.push(A(s))}return r}function p(e){var t,n,r,a=L(),o=[];for(t=0;t<e.length;t++)r=(n=e[t]).row,n.element&&(o[r]?o[r].push(n):o[r]=[n]);for(r=0;r<a;r++)o[r]=g(o[r]||[]);return o}function g(e){for(var t=[],n=m(e),r=0;r<n.length;r++)t.push.apply(t,n[r]);return t}function m(e){e.sort(pe);for(var t=[],n=0;n<e.length;n++){for(var r=e[n],a=0;a<t.length&&ve(r,t[a]);a++);t[a]?t[a].push(r):t[a]=[r]}return t}function y(){var e,t=L(),n=[];for(e=0;e<t;e++)n[e]=B(e).find("div.fc-day-content > div");return n}function b(e,t){var n=V();he(e,function(e,n,r){var a=e.event;a._id===t?w(a,n,e):n[0]._fci=r}),T(n,e,w)}function w(e,t,n){k(e)&&E.draggableDayEvent(e,t,n),n.isEnd&&R(e)&&E.resizableDayEvent(e,t,n),F(e,t)}function C(e,t){var n,r=G();t.draggable({delay:50,opacity:x("dragOpacity"),revertDuration:x("dragRevertDuration"),start:function(a,o){_("eventDragStart",t,e,a,o),z(e,t),r.start(function(r,a,o,i){if(t.draggable("option","revert",!r||!o&&!i),$(),r){var s=ee(a),c=ee(r);n=h(c,s),X(l(f(e.start),n),l(D(e),n))}else n=0},a,"drag")},stop:function(a,o){r.stop(),$(),_("eventDragStop",t,e,a,o),n?I(this,e,n,0,e.allDay,a,o):(t.css("filter",""),O(e,t))}})}function M(t,r,a){var o=x("isRTL")?"w":"e",i=r.find(".ui-resizable-"+o),s=!1;P(r),r.mousedown(function(e){e.preventDefault()}).click(function(e){s&&(e.preventDefault(),e.stopImmediatePropagation())}),i.mousedown(function(i){function c(n){_("eventResizeStop",this,t,n),e("body").css("cursor",""),f.stop(),$(),u&&W(this,t,u,0,n),setTimeout(function(){s=!1},0)}if(1==i.which){s=!0;var u,d,f=G(),v=(L(),q(),r.css("top")),h=e.extend({},t),p=ae(re(t.start));Z(),e("body").css("cursor",o+"-resize").one("mouseup",c),_("eventResizeStart",this,t,i),f.start(function(r,i){if(r){var s=te(i),c=te(r);if(c=Math.max(c,p),u=ne(c)-ne(s)){h.end=l(H(t),u,!0);var f=d;d=n(h,a.row,v),(d=e(d)).find("*").css("cursor",o+"-resize"),f&&f.remove(),z(t)}else d&&(O(t),d.remove(),d=null);$(),X(t.start,l(D(t),u))}},i)}})}var E=this;E.renderDayEvents=t,E.draggableDayEvent=C,E.resizableDayEvent=M;var x=E.opt,_=E.trigger,k=E.isEventDraggable,R=E.isEventResizable,H=E.eventEnd,N=E.reportEventElement,F=E.eventElementHandlers,O=E.showEvents,z=E.hideEvents,I=E.eventDrop,W=E.eventResize,L=E.getRowCnt,q=E.getColCnt,B=(E.getColWidth,E.allDayRow),U=(E.colLeft,E.colRight,E.colContentLeft),K=E.colContentRight,V=(E.dateToCell,E.getDaySegmentContainer),J=E.calendar.formatDates,X=E.renderDayOverlay,$=E.clearOverlays,Z=E.clearSelection,G=E.getHoverListener,Q=E.rangeToSegments,ee=E.cellToDate,te=E.cellToCellOffset,ne=E.cellOffsetToDayOffset,re=E.dateToDayOffset,ae=E.dayOffsetToCellOffset}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.leftCol<=e.rightCol&&r.rightCol>=e.leftCol)return!0}return!1}function he(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=r.element;a&&t(r,a,n)}}function pe(e,t){return t.rightCol-t.leftCol-(e.rightCol-e.leftCol)||t.event.allDay-e.event.allDay||e.event.start-t.event.start||(e.event.title||"").localeCompare(t.event.title)}function ge(){function t(e,t,a){n(),t||(t=l(e,a)),c(e,t,a),r(e,t,a)}function n(e){d&&(d=!1,u(),s("unselect",null,e))}function r(e,t,n,r){d=!0,s("select",null,e,t,n,r)}function a(t){var a=o.cellToDate,s=o.getIsCellAllDay,l=o.getHoverListener(),d=o.reportDayClick;if(1==t.which&&i("selectable")){n(t);var f;l.start(function(e,t){u(),e&&s(e)?(f=[a(t),a(e)].sort(I),c(f[0],f[1],!0)):f=null},t),e(document).one("mouseup",function(e){l.stop(),f&&(+f[0]==+f[1]&&d(f[0],!0,e),r(f[0],f[1],!0,e))})}}var o=this;o.select=t,o.unselect=n,o.reportSelection=r,o.daySelectionMousedown=a;var i=o.opt,s=o.trigger,l=o.defaultSelectionEnd,c=o.renderSelection,u=o.clearSelection,d=!1;i("selectable")&&i("unselectAuto")&&e(document).mousedown(function(t){var r=i("unselectCancel");r&&e(t.target).parents(r).length||n(t)})}function me(){function t(t,n){var r=o.shift();return r||(r=e("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),r[0].parentNode!=n[0]&&r.appendTo(n),a.push(r.css(t).show()),r}function n(){for(var e;e=a.shift();)o.push(e.hide().unbind())}var r=this;r.renderOverlay=t,r.clearOverlays=n;var a=[],o=[]}function ye(e){var t,n,r=this;r.build=function(){e(t=[],n=[])},r.cell=function(e,r){var a,o=t.length,i=n.length,s=-1,l=-1;for(a=0;a<o;a++)if(r>=t[a][0]&&r<t[a][1]){s=a;break}for(a=0;a<i;a++)if(e>=n[a][0]&&e<n[a][1]){l=a;break}return s>=0&&l>=0?{row:s,col:l}:null},r.rect=function(e,r,a,o,i){var s=i.offset();return{top:t[e][0]-s.top,left:n[r][0]-s.left,width:n[o][1]-n[r][0],height:t[a][1]-t[e][0]}}}function be(t){function n(e){we(e);var n=t.cell(e.pageX,e.pageY);(!n!=!i||n&&(n.row!=i.row||n.col!=i.col))&&(n?(o||(o=n),a(n,o,n.row-o.row,n.col-o.col)):a(n,o),i=n)}var r,a,o,i,s=this;s.start=function(s,l,c){a=s,o=i=null,t.build(),n(l),r=c||"mousemove",e(document).bind(r,n)},s.stop=function(){return e(document).unbind(r,n),i}}function we(e){e.pageX===t&&(e.pageX=e.originalEvent.pageX,e.pageY=e.originalEvent.pageY)}function Ce(e){function n(t){return a[t]=a[t]||e(t)}var r=this,a={},o={},i={};r.left=function(e){return o[e]=o[e]===t?n(e).position().left:o[e]},r.right=function(e){return i[e]=i[e]===t?r.left(e)+n(e).width():i[e]},r.clear=function(){a={},o={},i={}}}var De={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},Me={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},Te=e.fullCalendar={version:"1.6.4"},Ee=Te.views={};e.fn.fullCalendar=function(n){if("string"==typeof n){var a,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e.data(this,"fullCalendar");if(r&&e.isFunction(r[n])){var i=r[n].apply(r,o);a===t&&(a=i),"destroy"==n&&e.removeData(this,"fullCalendar")}}),a!==t?a:this}var i=(n=n||{}).eventSources||[];return delete n.eventSources,n.events&&(i.push(n.events),delete n.events),n=e.extend(!0,{},De,n.isRTL||n.isRTL===t&&De.isRTL?Me:{},n),this.each(function(t,a){var o=e(a),s=new r(o,n,i);o.data("fullCalendar",s),s.render()}),this},Te.sourceNormalizers=[],Te.sourceFetchers=[];var xe={dataType:"json",cache:!1},Se=1;Te.addDays=l,Te.cloneDate=f,Te.parseDate=g,Te.parseISO8601=m,Te.parseTime=y,Te.formatDate=b,Te.formatDates=w;var _e=["sun","mon","tue","wed","thu","fri","sat"],ke=864e5,Re=36e5,He=6e4,Ne={s:function(e){return e.getSeconds()},ss:function(e){return W(e.getSeconds())},m:function(e){return e.getMinutes()},mm:function(e){return W(e.getMinutes())},h:function(e){return e.getHours()%12||12},hh:function(e){return W(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return W(e.getHours())},d:function(e){return e.getDate()},dd:function(e){return W(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return W(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return e.getHours()<12?"a":"p"},tt:function(e){return e.getHours()<12?"am":"pm"},T:function(e){return e.getHours()<12?"A":"P"},TT:function(e){return e.getHours()<12?"AM":"PM"},u:function(e){return b(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&t<20?"th":["st","nd","rd"][t%10-1]||"th"},w:function(e,t){return t.weekNumberCalculation(e)},W:function(e){return C(e)}};Te.dateFormatters=Ne,Te.applyAll=B,Ee.month=K,Ee.basicWeek=V,Ee.basicDay=J,n({weekMode:"fixed"}),Ee.agendaWeek=Z,Ee.agendaDay=G,n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24,slotEventOverlap:!0})}(jQuery),function(e){"use strict";e.fn.easyCalendar=function(t){function n(t){var n=e("<div/>").appendTo(e("body"));return e.get(D.origin+t.url+"/edit.html",function(r){M(n,r,[{text:I18n.buttonSave,"class":"button-positive",click:function(){"undefined"!=typeof CKEDITOR&&CKEDITOR&&CKEDITOR.instances.easy_meeting_description&&CKEDITOR.instances.easy_meeting_description.updateElement(),e.ajax({url:D.origin+t.url+".json",type:"PUT",data:e("form",n).serialize(),complete:function(t){var r;422===t.status?(r=e.parseJSON(t.responseText),e(".flash",n).remove(),e("<div/>").addClass("flash error").prependTo(n).html(r.errors.join("</br>"))):(n.dialog("close"),y.fullCalendar("refetchEvents"))}})}},{text:I18n.buttonCancel,"class":"button",click:function(){n.dialog("close")}}]),h(n),"undefined"!=typeof t.parentUrl&&t.parentUrl.length>0&&v(t,n)}),!1}function r(){return D.calendarNewEvent}function a(t,n){var r=e("form",n);"undefined"!=typeof CKEDITOR&&CKEDITOR&&CKEDITOR.instances.easy_meeting_description&&CKEDITOR.instances.easy_meeting_description.updateElement(),e.ajax({url:t.create_record_path,type:"POST",data:r.serialize(),complete:function(t){var r;422===t.status?(r=e.parseJSON(t.responseText),e(".flash",n).remove(),e("<div/>").addClass("flash error").prependTo(n).html(r.errors.join("</br>"))):(n.dialog("close"),y.fullCalendar("refetchEvents"))}})}function o(n,o,i){var s=D.calendarTypes[r()],l=e("<div/>").addClass("new-event-dialog").addClass("active-dialog").appendTo("body");if(t.roomId&&l.attr("data-room-id",t.roomId),t.roomName&&l.attr("data-room-name",t.roomName),!s)return!1;e.get(s.new_record_path,{easy_meeting:{start_time:i?moment(n).startOf("day").toDate():n,end_time:i?moment(o).endOf("day").toDate():o,all_day:i?"1":"0"}},function(t){M(l,t,[{text:I18n.buttonSave,"class":"button-positive",click:function(){a(s,l)}},{text:I18n.buttonCancel,"class":"button",click:function(){e(this).dialog("close")}}])})}function i(e,t){var n;if(t.eventType&&(n=T[t.eventType])&&"function"==typeof n[e])return n[e].apply(null,[].splice.call(arguments,1))}function s(e,t,n){w.entityArray("add",{id:e,name:t,className:n})&&y.fullCalendar("addEventSource",{url:window.easyCalendarOptions.easy_calendar_user_availability+"?user_id="+e,className:n})}function l(){var t=[];e("input",w).each(function(){t.push(e(this).val())}),e.post(window.easyCalendarOptions.easy_calendar_save_availability,{user_ids:t,module_id:D.moduleId})}function c(){var t=[];e("#module_inside_"+D.moduleId+" .easy-cal-calendar-selection .entity-array input").each(function(){t.push(e(this).val())}),e.post(window.easyCalendarOptions.easy_calendar_save_calendars,{calendar_ids:t,module_id:D.moduleId},function(){y.fullCalendar("refetchEvents")})}function u(t){e(".easy-cal-title",b).html(t)}function d(e,t){e.prop("title",t)}function f(t,n){e('<span style="position:absolute;top: 0px;right: 0px;z-index:9"/>').addClass("icon icon-del delete-meeting").prependTo(t).click(function(){return confirm(I18n.meetingDestroyConfirmation)&&e.ajax({url:D.origin+n.url,type:"DELETE",success:function(){y.fullCalendar("refetchEvents")}}),!1})}function v(t,r){e(".easy-show-repeating-parent").click(function(e){e.preventDefault(),r.dialog("close"),n({url:t.parentUrl,parentUrl:""})})}function h(t){e(".easy-delete-meeting").bind("ajax:complete",function(){t.dialog("close"),y.fullCalendar("refetchEvents")})}var p,g,m,y=e(this),b=y.prev(".easy-calendar-header"),w=e(".easy-cal-selected-users",b),C="80%",D={events:{url:window.easyCalendarOptions.easy_calendar_feed+"?"+e.param({module_id:t.moduleId,user_calendars:null})},calendarTypes:[],minTime:t.minTime||0,maxTime:t.maxTime||24,defaultView:t.defaultView||"agendaWeek",calendarNewEvent:t.calendarNewEvent||"easy_meeting_calendar",urlPrefix:window.urlPrefix,origin:window.easyCalendarOptions.easy_calendar_base_url,firstDay:t.firstDay||1,firstHour:t.firstHour||8},M=function(t,n,r){var a;t.html(e(n)),a=e("h2",t).text(),e("h2",t).remove();var o=ERUI.topMenu.outerHeight(),i=window.innerHeight;t.dialog({title:a,width:C,buttons:r,modal:!0,resizable:!1,maxHeight:i-o,close:function(){t.dialog("close").remove(),ERUI.body.removeClass("modal-opened")},open:function(){initEasyAutocomplete(),ERUI.body.addClass("modal-opened")}})},T={meeting_detail:{click:function(t){var n=e("<div/>").appendTo(e("body"));return e.get(D.origin+t.url,function(e){M(n,e,{})}),!1},afterRender:function(e,t){e.editable&&f(t,e),d(t,e.title)}},meeting_invitation:{click:function(t){var n=e("<div/>").appendTo(e("body")),r={};return!1!==t.accepted&&t.accepted!==undefined||(r.accept={text:I18n.meetingAccept,"class":"button-positive",tabIndex:-1,click:function(){e.post(D.origin+t.url+"/accept",function(){y.fullCalendar("refetchEvents"),n.dialog("close")})}}),!1!==t.declined&&t.declined!==undefined||(r.decline={text:I18n.meetingDecline,"class":"button",tabIndex:-1,click:function(){e.post(D.origin+t.url+"/decline",function(){y.fullCalendar("refetchEvents"),n.dialog("close")})}}),t.editable&&(r.edit={text:I18n.meetingEdit,"class":"button",tabIndex:-1,click:function(){var r=e("<div/>").appendTo(e("body"));return e.get(D.origin+t.url+"/edit",function(a){n.dialog("close"),M(r,a,[{text:I18n.buttonSave,"class":"button-positive",click:function(){"undefined"!=typeof CKEDITOR&&CKEDITOR&&CKEDITOR.instances.easy_meeting_description&&CKEDITOR.instances.easy_meeting_description.updateElement(),e.ajax({url:D.origin+t.url+".json",type:"PUT",data:e("form",r).serialize(),complete:function(t){var n;422===t.status?(n=e.parseJSON(t.responseText),e(".flash",r).remove(),e("<div/>").addClass("flash error").prependTo(r).html(n.errors.join("</br>"))):(r.dialog("close"),y.fullCalendar("refetchEvents"))}})}},{text:I18n.buttonCancel,"class":"button",click:function(){r.dialog("close")}}]),h(r),"undefined"!=typeof t.parentUrl&&t.parentUrl.length>0&&v(t,r)}),!1}}),e.get(D.origin+t.url,function(e){M(n,e,r)}),!1},render:function(e,t){!0===e.accepted?t.addClass("invitation-accepted"):!0===e.declined?t.addClass("invitation-declined"):t.addClass("invitation-new")},afterRender:function(e,t){e.editable&&f(t,e),d(t,e.title)}},easy_crm_case_contract:{afterRender:function(t,n){e(n).find(".fc-event-inner").addClass("icon-money")}},easy_crm_case_next_action:{afterRender:function(t,n){e(n).find(".fc-event-inner").addClass("icon-move")}},issue:{afterRender:function(e){console.warn("attempt to bind tooltip on issue",e)}},meeting:{change:function(t){e.ajax({url:D.origin+t.url,type:"PUT",data:{format:"json",easy_meeting:{start_time:t.start,end_time:t.end,all_day:t.allDay}},error:function(){y.fullCalendar("refetchEvents")}})},click:n,afterRender:function(t,n){var r;t.editable&&f(n,t),t.bigRecurringChildren&&e('<span style="position:absolute;top: 0px;right: 0px;z-index:9"/>').addClass("icon icon-reload").prependTo(n),t.location&&((r=e(".fc-event-title",n)).length>0?e("<div/>").html(t.location).addClass("fc-event-location").insertAfter(r):e(".fc-event-time",n).append(" - "+t.location)),d(n,t.title)}},availability_meeting:{afterRender:function(e,t){e.editable&&f(t,e),d(t,e.title)}},easy_attendance:{render:function(e,t){let n=t[0].children[0],r="<span class='easy-calendar__event_body-action'><i class='icon easy-calendar__event-icon-meeting--approvable'></i></span>",a="<span class='easy-calendar__event_body-action'><i class='icon easy-calendar__event-icon-meeting--confirmed'></i></span>",o="<span class='easy-calendar__event_body-action'><i class='icon easy-calendar__event-icon-meeting--rejected'></i></span>";e.confirmed?n.innerHTML+=`<span class="fc-event-icon">${a}</span>`:e.needApprove?n.innerHTML+=`<span class="fc-event-icon">${r}</span>`:n.innerHTML+=`<span class="fc-event-icon">${o}</span>`}}};e.extend(D,t),y.fullCalendar(e.extend(D,{header:"",editable:!1,selectable:!0,monthNamesShort:moment.monthsShort(),monthNames:moment.months(),dayNames:moment.weekdays(),dayNamesShort:moment.weekdaysShort(),axisFormat:"H:mm",timeFormat:"H:mm",columnFormat:t.columnFormat||{month:"dddd",week:"dddd d. M.",day:"dddd d. M."},select:function(e,t,n){o(e,t,n),y.fullCalendar("unselect")},eventClick:function(e){return i("click",e)},eventDrop:function(e){return i("change",e)},eventResize:function(e){return i("change",e)},eventRender:function(e,t,n){return i("render",e,t,n)},eventAfterRender:function(e,t,n){return i("afterRender",e,t,n)},viewRender:function(){var e,t=y.fullCalendar("getView");u(t.title),e="month"===t.name?NaN:5500,y.fullCalendar("option","contentHeight",e)}})),y.closest(".module-content").prev(".module-toggle-button").click(function(){y.fullCalendar("render")}),p=e("#"+y[0].id+"-user-select"),g=e("#"+y[0].id+"-user-select_autocomplete"),m=0,w.entityArray({afterRemove:function(e){y.fullCalendar("removeEventSource",window.easyCalendarOptions.easy_calendar_user_availability+"?user_id="+e.id),l()}}),p.change(function(){s(p.val(),g.val(),"palette-"+(m+1)),p.val(""),g.val(""),m+=1,l()}),D.users&&e.each(D.users,function(){s(this.id,this.name,"palette-"+(m+1)),p.val(""),g.val(""),m+=1}),e("#"+y[0].id+"-calendar-select").change(function(){c()}),e(".easy-cal-prev",b).click(function(){return y.fullCalendar("prev"),!1}),e(".easy-cal-next",b).click(function(){return y.fullCalendar("next"),!1}),e(".easy-cal-month",b).click(function(){return e(this).addClass("pressed").siblings().removeClass("pressed"),y.fullCalendar("changeView","month"),!1}),e(".easy-cal-week",b).click(function(){return e(this).addClass("pressed").siblings().removeClass("pressed"),y.fullCalendar("changeView","agendaWeek"),!1}),e(".easy-cal-day",b).click(function(){return e(this).addClass("pressed").siblings().removeClass("pressed"),y.fullCalendar("changeView","agendaDay"),!1})}}(jQuery);