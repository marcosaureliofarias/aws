function jsInitScript(){jQuery("#subtasks").sortable({placeholder:"ui-state-highlight",containment:"#subtasks",start:function(){jQuery(".ui-state-highlight").html("<div style='background:#4466AA; width: 800px; height: 5px; clear: both;'></div>")},update:function(){updateSubtaskPositionFields()}}),jQuery("div.subtask_select_container select").change(function(){changeSubtaskRowColor(jQuery(this).parent().parent().parent(),this.value)})}function changeSubtaskRowColor(e,t){switch(jQuery(e).removeClass("subtask"),jQuery(e).removeClass("variant"),jQuery(e).removeClass("problem"),t){case"0":jQuery(e).addClass("subtask");break;case"1":jQuery(e).addClass("variant");break;case"2":jQuery(e).addClass("problem")}}function updateSubtaskPositionFields(){var e=1;jQuery("#subtasks").children("div").each(function(){jQuery(this).attr("id","subtask_drag_"+e),jQuery(this).children(".position").attr("value",e),e++})}function add_fields(e,t,s){var a=new Date,i=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds());Math.round((new Date).getTime()/1e3);switch(t){case"re_subtask":s=replaceAll(s,"new_re_subtask",i.toString().substring(5,12)),addSubtask(e,s)}}function remove_fields(e){jQuery(e).prev("input[type=hidden]").val("1"),jQuery(e).closest(".nested_field").hide()}function replaceAll(e,t,s){return e.replace(new RegExp(t,"g"),s)}updateSubtaskPositionFields(),jQuery(document).ready(function(){jsInitScript()});