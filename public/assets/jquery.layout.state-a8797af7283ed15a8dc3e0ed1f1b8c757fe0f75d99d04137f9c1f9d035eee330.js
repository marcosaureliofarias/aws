!function(e){e.layout&&(e.ui||(e.ui={}),e.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(t){var a,n,o,i=document.cookie,s=i?i.split(";"):[];for(o=0;a=s[o];o++)if((n=e.trim(a).split("="))[0]==t)return decodeURIComponent(n[1]);return null},write:function(t,a,n){var o="",i="",s=!1,d=n||{},r=d.expires||null,u=e.type(r);"date"===u?i=r:"string"===u&&r>0&&(r=parseInt(r,10),u="number"),"number"===u&&(i=new Date,r>0?i.setDate(i.getDate()+r):(i.setFullYear(1970),s=!0)),i&&(o+=";expires="+i.toUTCString()),d.path&&(o+=";path="+d.path),d.domain&&(o+=";domain="+d.domain),d.secure&&(o+=";secure"),document.cookie=t+"="+(s?"":encodeURIComponent(a))+o},clear:function(t){e.ui.cookie.write(t,"",{expires:-1})}},e.cookie||(e.cookie=function(t,a,n){var o=e.ui.cookie;if(null===a)o.clear(t);else{if(a===undefined)return o.read(t);o.write(t,a,n)}}),e.layout.plugins.stateManagement=!0,e.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,animateLoad:!0,includeChildren:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}},e.layout.optionsMap.layout.push("stateManagement"),e.layout.config.optionRootKeys.push("stateManagement"),e.layout.state={saveCookie:function(t,a,n){var o=t.options,i=o.stateManagement,s=e.extend(!0,{},i.cookie,n||null),d=t.state.stateData=t.readState(a||i.stateKeys);return e.ui.cookie.write(s.name||o.name||"Layout",e.layout.state.encodeJSON(d),s),e.extend(!0,{},d)},deleteCookie:function(t){var a=t.options;e.ui.cookie.clear(a.stateManagement.cookie.name||a.name||"Layout")},readCookie:function(t){var a=t.options,n=e.ui.cookie.read(a.stateManagement.cookie.name||a.name||"Layout");return n?e.layout.state.decodeJSON(n):{}},loadCookie:function(t){var a=e.layout.state.readCookie(t);return a&&!e.isEmptyObject(a)&&(t.state.stateData=e.extend(!0,{},a),t.loadState(a)),a},loadState:function(t,a,n){if(e.isPlainObject(a)&&!e.isEmptyObject(a)){a=t.state.stateData=e.layout.transformData(a);var o=t.options.stateManagement;if(n=e.extend({animateLoad:!1,includeChildren:o.includeChildren},n),t.state.initialized){var i,d,r,u,l,c,f=!n.animateLoad;if(e.each(e.layout.config.borderPanes,function(n,o){p=a[o],e.isPlainObject(p)&&(s=p.size,i=p.initClosed,d=p.initHidden,ar=p.autoResize,r=t.state[o],u=r.isVisible,ar&&(r.autoResize=ar),u||t._sizePane(o,s,!1,!1,!1),!0===d?t.hide(o,f):!0===i?t.close(o,!1,f):!1===i?t.open(o,!1,f):!1===d&&t.show(o,!1,f),u&&t._sizePane(o,s,!1,!1,f))}),n.includeChildren)e.each(t.children,function(t,n){(l=a[t]?a[t].children:0)&&n&&e.each(n,function(e,t){c=l[e],t&&c&&t.loadState(c)})})}else{var p=e.extend(!0,{},a);e.each(e.layout.config.allPanes,function(e,t){p[t]&&delete p[t].children}),e.extend(!0,t.options,p)}}},readState:function(t,a){"string"===e.type(a)&&(a={keys:a}),a||(a={});var n,o,i,s,d,r,u,l=t.options.stateManagement,c=a.includeChildren,f=c!==undefined?c:l.includeChildren,p=a.stateKeys||l.stateKeys,y={isClosed:"initClosed",isHidden:"initHidden"},h=t.state,m=e.layout.config.allPanes,C={};e.isArray(p)&&(p=p.join(","));for(var k=0,S=(p=p.replace(/__/g,".").split(",")).length;k<S;k++)o=(n=p[k].split("."))[0],i=n[1],e.inArray(o,m)<0||(s=h[o][i])!=undefined&&("isClosed"==i&&h[o].isSliding&&(s=!0),(C[o]||(C[o]={}))[y[i]?y[i]:i]=s);return f&&e.each(m,function(a,n){r=t.children[n],d=h.stateData[n],e.isPlainObject(r)&&!e.isEmptyObject(r)&&((u=C[n]||(C[n]={})).children||(u.children={}),e.each(r,function(t,a){a.state.initialized?u.children[t]=e.layout.state.readState(a):d&&d.children&&d.children[t]&&(u.children[t]=e.extend(!0,{},d.children[t]))}))}),C},encodeJSON:function(t){function a(t){var a,n,o,i=[],s=0,d=e.isArray(t);for(a in t)"string"==(o=typeof(n=t[a]))?n='"'+n+'"':"object"==o&&(n=parse(n)),i[s++]=(d?"":'"'+a+'":')+n;return(d?"[":"{")+i.join(",")+(d?"]":"}")}return((window.JSON||{}).stringify||a)(t)},decodeJSON:function(t){try{return e.parseJSON?e.parseJSON(t):window.eval("("+t+")")||{}}catch(a){return{}}},_create:function(t){var a=e.layout.state,n=t.options.stateManagement;if(e.extend(t,{readCookie:function(){return a.readCookie(t)},deleteCookie:function(){a.deleteCookie(t)},saveCookie:function(e,n){return a.saveCookie(t,e,n)},loadCookie:function(){return a.loadCookie(t)},loadState:function(e,n){a.loadState(t,e,n)},readState:function(e){return a.readState(t,e)},encodeJSON:a.encodeJSON,decodeJSON:a.decodeJSON}),t.state.stateData={},n.autoLoad)if(e.isPlainObject(n.autoLoad))e.isEmptyObject(n.autoLoad)||t.loadState(n.autoLoad);else if(n.enabled)if(e.isFunction(n.autoLoad)){var o={};try{o=n.autoLoad(t,t.state,t.options,t.options.name||"")}catch(i){}o&&e.isPlainObject(o)&&!e.isEmptyObject(o)&&t.loadState(o)}else t.loadCookie()},_unload:function(t){var a=t.options.stateManagement;if(a.enabled&&a.autoSave)if(e.isFunction(a.autoSave))try{a.autoSave(t,t.state,t.options,t.options.name||"")}catch(n){}else t.saveCookie()}},e.layout.onCreate.push(e.layout.state._create),e.layout.onUnload.push(e.layout.state._unload))}(jQuery);